{"remainingRequest":"/Users/js/Google Drive/_Github/github_upload/eotemp/node_modules/thread-loader/dist/cjs.js!/Users/js/Google Drive/_Github/github_upload/eotemp/node_modules/babel-loader/lib/index.js!/Users/js/Google Drive/_Github/github_upload/eotemp/node_modules/vuetify/lib/components/VSelect/VSelect.js","dependencies":[{"path":"/Users/js/Google Drive/_Github/github_upload/eotemp/node_modules/vuetify/lib/components/VSelect/VSelect.js","mtime":499162500000},{"path":"/Users/js/Google Drive/_Github/github_upload/eotemp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/js/Google Drive/_Github/github_upload/eotemp/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/js/Google Drive/_Github/github_upload/eotemp/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9Vc2Vycy9qcy9Hb29nbGUgRHJpdmUvX0dpdGh1Yi9naXRodWJfdXBsb2FkL2VvdGVtcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiL1VzZXJzL2pzL0dvb2dsZSBEcml2ZS9fR2l0aHViL2dpdGh1Yl91cGxvYWQvZW90ZW1wL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gIi9Vc2Vycy9qcy9Hb29nbGUgRHJpdmUvX0dpdGh1Yi9naXRodWJfdXBsb2FkL2VvdGVtcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmRhdGUudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaXMtYXJyYXkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZWR1Y2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi50aW1lcnMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZnJvbS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnN0YXJ0cy13aXRoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwovLyBTdHlsZXMKaW1wb3J0ICIuLi8uLi8uLi9zcmMvY29tcG9uZW50cy9WVGV4dEZpZWxkL1ZUZXh0RmllbGQuc2FzcyI7CmltcG9ydCAiLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVlNlbGVjdC9WU2VsZWN0LnNhc3MiOyAvLyBDb21wb25lbnRzCgppbXBvcnQgVkNoaXAgZnJvbSAnLi4vVkNoaXAnOwppbXBvcnQgVk1lbnUgZnJvbSAnLi4vVk1lbnUnOwppbXBvcnQgVlNlbGVjdExpc3QgZnJvbSAnLi9WU2VsZWN0TGlzdCc7IC8vIEV4dGVuc2lvbnMKCmltcG9ydCBWSW5wdXQgZnJvbSAnLi4vVklucHV0JzsKaW1wb3J0IFZUZXh0RmllbGQgZnJvbSAnLi4vVlRleHRGaWVsZC9WVGV4dEZpZWxkJzsgLy8gTWl4aW5zCgppbXBvcnQgQ29tcGFyYWJsZSBmcm9tICcuLi8uLi9taXhpbnMvY29tcGFyYWJsZSc7CmltcG9ydCBEZXBlbmRlbnQgZnJvbSAnLi4vLi4vbWl4aW5zL2RlcGVuZGVudCc7CmltcG9ydCBGaWx0ZXJhYmxlIGZyb20gJy4uLy4uL21peGlucy9maWx0ZXJhYmxlJzsgLy8gRGlyZWN0aXZlcwoKaW1wb3J0IENsaWNrT3V0c2lkZSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL2NsaWNrLW91dHNpZGUnOyAvLyBVdGlsaXRpZXMKCmltcG9ydCBtZXJnZURhdGEgZnJvbSAnLi4vLi4vdXRpbC9tZXJnZURhdGEnOwppbXBvcnQgeyBnZXRQcm9wZXJ0eUZyb21JdGVtLCBnZXRPYmplY3RWYWx1ZUJ5UGF0aCwga2V5Q29kZXMgfSBmcm9tICcuLi8uLi91dGlsL2hlbHBlcnMnOwppbXBvcnQgeyBjb25zb2xlRXJyb3IgfSBmcm9tICcuLi8uLi91dGlsL2NvbnNvbGUnOyAvLyBUeXBlcwoKaW1wb3J0IG1peGlucyBmcm9tICcuLi8uLi91dGlsL21peGlucyc7CmV4cG9ydCB2YXIgZGVmYXVsdE1lbnVQcm9wcyA9IHsKICBjbG9zZU9uQ2xpY2s6IGZhbHNlLAogIGNsb3NlT25Db250ZW50Q2xpY2s6IGZhbHNlLAogIGRpc2FibGVLZXlzOiB0cnVlLAogIG9wZW5PbkNsaWNrOiBmYWxzZSwKICBtYXhIZWlnaHQ6IDMwNAp9OyAvLyBUeXBlcwoKdmFyIGJhc2VNaXhpbnMgPSBtaXhpbnMoVlRleHRGaWVsZCwgQ29tcGFyYWJsZSwgRGVwZW5kZW50LCBGaWx0ZXJhYmxlKTsKLyogQHZ1ZS9jb21wb25lbnQgKi8KCmV4cG9ydCBkZWZhdWx0IGJhc2VNaXhpbnMuZXh0ZW5kKCkuZXh0ZW5kKHsKICBuYW1lOiAndi1zZWxlY3QnLAogIGRpcmVjdGl2ZXM6IHsKICAgIENsaWNrT3V0c2lkZTogQ2xpY2tPdXRzaWRlCiAgfSwKICBwcm9wczogewogICAgYXBwZW5kSWNvbjogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICJkZWZhdWx0IjogJyRkcm9wZG93bicKICAgIH0sCiAgICBhdHRhY2g6IHsKICAgICAgdHlwZTogbnVsbCwKICAgICAgImRlZmF1bHQiOiBmYWxzZQogICAgfSwKICAgIGNhY2hlSXRlbXM6IEJvb2xlYW4sCiAgICBjaGlwczogQm9vbGVhbiwKICAgIGNsZWFyYWJsZTogQm9vbGVhbiwKICAgIGRlbGV0YWJsZUNoaXBzOiBCb29sZWFuLAogICAgZGlzYWJsZUxvb2t1cDogQm9vbGVhbiwKICAgIGVhZ2VyOiBCb29sZWFuLAogICAgaGlkZVNlbGVjdGVkOiBCb29sZWFuLAogICAgaXRlbXM6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgICJkZWZhdWx0IjogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CiAgICB9LAogICAgaXRlbUNvbG9yOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgImRlZmF1bHQiOiAncHJpbWFyeScKICAgIH0sCiAgICBpdGVtRGlzYWJsZWQ6IHsKICAgICAgdHlwZTogW1N0cmluZywgQXJyYXksIEZ1bmN0aW9uXSwKICAgICAgImRlZmF1bHQiOiAnZGlzYWJsZWQnCiAgICB9LAogICAgaXRlbVRleHQ6IHsKICAgICAgdHlwZTogW1N0cmluZywgQXJyYXksIEZ1bmN0aW9uXSwKICAgICAgImRlZmF1bHQiOiAndGV4dCcKICAgIH0sCiAgICBpdGVtVmFsdWU6IHsKICAgICAgdHlwZTogW1N0cmluZywgQXJyYXksIEZ1bmN0aW9uXSwKICAgICAgImRlZmF1bHQiOiAndmFsdWUnCiAgICB9LAogICAgbWVudVByb3BzOiB7CiAgICAgIHR5cGU6IFtTdHJpbmcsIEFycmF5LCBPYmplY3RdLAogICAgICAiZGVmYXVsdCI6IGZ1bmN0aW9uIF9kZWZhdWx0KCkgewogICAgICAgIHJldHVybiBkZWZhdWx0TWVudVByb3BzOwogICAgICB9CiAgICB9LAogICAgbXVsdGlwbGU6IEJvb2xlYW4sCiAgICBvcGVuT25DbGVhcjogQm9vbGVhbiwKICAgIHJldHVybk9iamVjdDogQm9vbGVhbiwKICAgIHNtYWxsQ2hpcHM6IEJvb2xlYW4KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjYWNoZWRJdGVtczogdGhpcy5jYWNoZUl0ZW1zID8gdGhpcy5pdGVtcyA6IFtdLAogICAgICBtZW51SXNCb290ZWQ6IGZhbHNlLAogICAgICBpc01lbnVBY3RpdmU6IGZhbHNlLAogICAgICBsYXN0SXRlbTogMjAsCiAgICAgIC8vIEFzIGxvbmcgYXMgYSB2YWx1ZSBpcyBkZWZpbmVkLCBzaG93IGl0CiAgICAgIC8vIE90aGVyd2lzZSwgY2hlY2sgaWYgbXVsdGlwbGUKICAgICAgLy8gdG8gZGV0ZXJtaW5lIHdoaWNoIGRlZmF1bHQgdG8gcHJvdmlkZQogICAgICBsYXp5VmFsdWU6IHRoaXMudmFsdWUgIT09IHVuZGVmaW5lZCA/IHRoaXMudmFsdWUgOiB0aGlzLm11bHRpcGxlID8gW10gOiB1bmRlZmluZWQsCiAgICAgIHNlbGVjdGVkSW5kZXg6IC0xLAogICAgICBzZWxlY3RlZEl0ZW1zOiBbXSwKICAgICAga2V5Ym9hcmRMb29rdXBQcmVmaXg6ICcnLAogICAgICBrZXlib2FyZExvb2t1cExhc3RUaW1lOiAwCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC8qIEFsbCBpdGVtcyB0aGF0IHRoZSBzZWxlY3QgaGFzICovCiAgICBhbGxJdGVtczogZnVuY3Rpb24gYWxsSXRlbXMoKSB7CiAgICAgIHJldHVybiB0aGlzLmZpbHRlckR1cGxpY2F0ZXModGhpcy5jYWNoZWRJdGVtcy5jb25jYXQodGhpcy5pdGVtcykpOwogICAgfSwKICAgIGNsYXNzZXM6IGZ1bmN0aW9uIGNsYXNzZXMoKSB7CiAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIFZUZXh0RmllbGQub3B0aW9ucy5jb21wdXRlZC5jbGFzc2VzLmNhbGwodGhpcykpLCB7fSwgewogICAgICAgICd2LXNlbGVjdCc6IHRydWUsCiAgICAgICAgJ3Ytc2VsZWN0LS1jaGlwcyc6IHRoaXMuaGFzQ2hpcHMsCiAgICAgICAgJ3Ytc2VsZWN0LS1jaGlwcy0tc21hbGwnOiB0aGlzLnNtYWxsQ2hpcHMsCiAgICAgICAgJ3Ytc2VsZWN0LS1pcy1tZW51LWFjdGl2ZSc6IHRoaXMuaXNNZW51QWN0aXZlLAogICAgICAgICd2LXNlbGVjdC0taXMtbXVsdGknOiB0aGlzLm11bHRpcGxlCiAgICAgIH0pOwogICAgfSwKCiAgICAvKiBVc2VkIGJ5IG90aGVyIGNvbXBvbmVudHMgdG8gb3ZlcndyaXRlICovCiAgICBjb21wdXRlZEl0ZW1zOiBmdW5jdGlvbiBjb21wdXRlZEl0ZW1zKCkgewogICAgICByZXR1cm4gdGhpcy5hbGxJdGVtczsKICAgIH0sCiAgICBjb21wdXRlZE93bnM6IGZ1bmN0aW9uIGNvbXB1dGVkT3ducygpIHsKICAgICAgcmV0dXJuICJsaXN0LSIuY29uY2F0KHRoaXMuX3VpZCk7CiAgICB9LAogICAgY29tcHV0ZWRDb3VudGVyVmFsdWU6IGZ1bmN0aW9uIGNvbXB1dGVkQ291bnRlclZhbHVlKCkgewogICAgICB2YXIgdmFsdWUgPSB0aGlzLm11bHRpcGxlID8gdGhpcy5zZWxlY3RlZEl0ZW1zIDogKHRoaXMuZ2V0VGV4dCh0aGlzLnNlbGVjdGVkSXRlbXNbMF0pIHx8ICcnKS50b1N0cmluZygpOwoKICAgICAgaWYgKHR5cGVvZiB0aGlzLmNvdW50ZXJWYWx1ZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHJldHVybiB0aGlzLmNvdW50ZXJWYWx1ZSh2YWx1ZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB2YWx1ZS5sZW5ndGg7CiAgICB9LAogICAgZGlyZWN0aXZlczogZnVuY3Rpb24gZGlyZWN0aXZlcygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiB0aGlzLmlzRm9jdXNlZCA/IFt7CiAgICAgICAgbmFtZTogJ2NsaWNrLW91dHNpZGUnLAogICAgICAgIHZhbHVlOiB7CiAgICAgICAgICBoYW5kbGVyOiB0aGlzLmJsdXIsCiAgICAgICAgICBjbG9zZUNvbmRpdGlvbmFsOiB0aGlzLmNsb3NlQ29uZGl0aW9uYWwsCiAgICAgICAgICBpbmNsdWRlOiBmdW5jdGlvbiBpbmNsdWRlKCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMuZ2V0T3BlbkRlcGVuZGVudEVsZW1lbnRzKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9XSA6IHVuZGVmaW5lZDsKICAgIH0sCiAgICBkeW5hbWljSGVpZ2h0OiBmdW5jdGlvbiBkeW5hbWljSGVpZ2h0KCkgewogICAgICByZXR1cm4gJ2F1dG8nOwogICAgfSwKICAgIGhhc0NoaXBzOiBmdW5jdGlvbiBoYXNDaGlwcygpIHsKICAgICAgcmV0dXJuIHRoaXMuY2hpcHMgfHwgdGhpcy5zbWFsbENoaXBzOwogICAgfSwKICAgIGhhc1Nsb3Q6IGZ1bmN0aW9uIGhhc1Nsb3QoKSB7CiAgICAgIHJldHVybiBCb29sZWFuKHRoaXMuaGFzQ2hpcHMgfHwgdGhpcy4kc2NvcGVkU2xvdHMuc2VsZWN0aW9uKTsKICAgIH0sCiAgICBpc0RpcnR5OiBmdW5jdGlvbiBpc0RpcnR5KCkgewogICAgICByZXR1cm4gdGhpcy5zZWxlY3RlZEl0ZW1zLmxlbmd0aCA+IDA7CiAgICB9LAogICAgbGlzdERhdGE6IGZ1bmN0aW9uIGxpc3REYXRhKCkgewogICAgICB2YXIgc2NvcGVJZCA9IHRoaXMuJHZub2RlICYmIHRoaXMuJHZub2RlLmNvbnRleHQuJG9wdGlvbnMuX3Njb3BlSWQ7CiAgICAgIHZhciBhdHRycyA9IHNjb3BlSWQgPyBfZGVmaW5lUHJvcGVydHkoe30sIHNjb3BlSWQsIHRydWUpIDoge307CiAgICAgIHJldHVybiB7CiAgICAgICAgYXR0cnM6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgYXR0cnMpLCB7fSwgewogICAgICAgICAgaWQ6IHRoaXMuY29tcHV0ZWRPd25zCiAgICAgICAgfSksCiAgICAgICAgcHJvcHM6IHsKICAgICAgICAgIGFjdGlvbjogdGhpcy5tdWx0aXBsZSwKICAgICAgICAgIGNvbG9yOiB0aGlzLml0ZW1Db2xvciwKICAgICAgICAgIGRlbnNlOiB0aGlzLmRlbnNlLAogICAgICAgICAgaGlkZVNlbGVjdGVkOiB0aGlzLmhpZGVTZWxlY3RlZCwKICAgICAgICAgIGl0ZW1zOiB0aGlzLnZpcnR1YWxpemVkSXRlbXMsCiAgICAgICAgICBpdGVtRGlzYWJsZWQ6IHRoaXMuaXRlbURpc2FibGVkLAogICAgICAgICAgaXRlbVRleHQ6IHRoaXMuaXRlbVRleHQsCiAgICAgICAgICBpdGVtVmFsdWU6IHRoaXMuaXRlbVZhbHVlLAogICAgICAgICAgbm9EYXRhVGV4dDogdGhpcy4kdnVldGlmeS5sYW5nLnQodGhpcy5ub0RhdGFUZXh0KSwKICAgICAgICAgIHNlbGVjdGVkSXRlbXM6IHRoaXMuc2VsZWN0ZWRJdGVtcwogICAgICAgIH0sCiAgICAgICAgb246IHsKICAgICAgICAgIHNlbGVjdDogdGhpcy5zZWxlY3RJdGVtCiAgICAgICAgfSwKICAgICAgICBzY29wZWRTbG90czogewogICAgICAgICAgaXRlbTogdGhpcy4kc2NvcGVkU2xvdHMuaXRlbQogICAgICAgIH0KICAgICAgfTsKICAgIH0sCiAgICBzdGF0aWNMaXN0OiBmdW5jdGlvbiBzdGF0aWNMaXN0KCkgewogICAgICBpZiAodGhpcy4kc2xvdHNbJ25vLWRhdGEnXSB8fCB0aGlzLiRzbG90c1sncHJlcGVuZC1pdGVtJ10gfHwgdGhpcy4kc2xvdHNbJ2FwcGVuZC1pdGVtJ10pIHsKICAgICAgICBjb25zb2xlRXJyb3IoJ2Fzc2VydDogc3RhdGljTGlzdCBzaG91bGQgbm90IGJlIGNhbGxlZCBpZiBzbG90cyBhcmUgdXNlZCcpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudChWU2VsZWN0TGlzdCwgdGhpcy5saXN0RGF0YSk7CiAgICB9LAogICAgdmlydHVhbGl6ZWRJdGVtczogZnVuY3Rpb24gdmlydHVhbGl6ZWRJdGVtcygpIHsKICAgICAgcmV0dXJuIHRoaXMuJF9tZW51UHJvcHMuYXV0byA/IHRoaXMuY29tcHV0ZWRJdGVtcyA6IHRoaXMuY29tcHV0ZWRJdGVtcy5zbGljZSgwLCB0aGlzLmxhc3RJdGVtKTsKICAgIH0sCiAgICBtZW51Q2FuU2hvdzogZnVuY3Rpb24gbWVudUNhblNob3coKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSwKICAgICRfbWVudVByb3BzOiBmdW5jdGlvbiAkX21lbnVQcm9wcygpIHsKICAgICAgdmFyIG5vcm1hbGlzZWRQcm9wcyA9IHR5cGVvZiB0aGlzLm1lbnVQcm9wcyA9PT0gJ3N0cmluZycgPyB0aGlzLm1lbnVQcm9wcy5zcGxpdCgnLCcpIDogdGhpcy5tZW51UHJvcHM7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShub3JtYWxpc2VkUHJvcHMpKSB7CiAgICAgICAgbm9ybWFsaXNlZFByb3BzID0gbm9ybWFsaXNlZFByb3BzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwKSB7CiAgICAgICAgICBhY2NbcC50cmltKCldID0gdHJ1ZTsKICAgICAgICAgIHJldHVybiBhY2M7CiAgICAgICAgfSwge30pOwogICAgICB9CgogICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBkZWZhdWx0TWVudVByb3BzKSwge30sIHsKICAgICAgICBlYWdlcjogdGhpcy5lYWdlciwKICAgICAgICB2YWx1ZTogdGhpcy5tZW51Q2FuU2hvdyAmJiB0aGlzLmlzTWVudUFjdGl2ZSwKICAgICAgICBudWRnZUJvdHRvbTogbm9ybWFsaXNlZFByb3BzLm9mZnNldFkgPyAxIDogMAogICAgICB9LCBub3JtYWxpc2VkUHJvcHMpOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIGludGVybmFsVmFsdWU6IGZ1bmN0aW9uIGludGVybmFsVmFsdWUodmFsKSB7CiAgICAgIHRoaXMuaW5pdGlhbFZhbHVlID0gdmFsOwogICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbXMoKTsKICAgIH0sCiAgICBpc01lbnVBY3RpdmU6IGZ1bmN0aW9uIGlzTWVudUFjdGl2ZSh2YWwpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5vbk1lbnVBY3RpdmVDaGFuZ2UodmFsKTsKICAgICAgfSk7CiAgICB9LAogICAgaXRlbXM6IHsKICAgICAgaW1tZWRpYXRlOiB0cnVlLAogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKHZhbCkgewogICAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgICBpZiAodGhpcy5jYWNoZUl0ZW1zKSB7CiAgICAgICAgICAvLyBCcmVha3MgdnVlLXRlc3QtdXRpbHMgaWYKICAgICAgICAgIC8vIHRoaXMgaXNuJ3QgY2FsY3VsYXRlZAogICAgICAgICAgLy8gb24gdGhlIG5leHQgdGljawogICAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpczMuY2FjaGVkSXRlbXMgPSBfdGhpczMuZmlsdGVyRHVwbGljYXRlcyhfdGhpczMuY2FjaGVkSXRlbXMuY29uY2F0KHZhbCkpOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbXMoKTsKICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLyoqIEBwdWJsaWMgKi8KICAgIGJsdXI6IGZ1bmN0aW9uIGJsdXIoZSkgewogICAgICBWVGV4dEZpZWxkLm9wdGlvbnMubWV0aG9kcy5ibHVyLmNhbGwodGhpcywgZSk7CiAgICAgIHRoaXMuaXNNZW51QWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMuaXNGb2N1c2VkID0gZmFsc2U7CiAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IC0xOwogICAgICB0aGlzLnNldE1lbnVJbmRleCgtMSk7CiAgICB9LAoKICAgIC8qKiBAcHVibGljICovCiAgICBhY3RpdmF0ZU1lbnU6IGZ1bmN0aW9uIGFjdGl2YXRlTWVudSgpIHsKICAgICAgaWYgKCF0aGlzLmlzSW50ZXJhY3RpdmUgfHwgdGhpcy5pc01lbnVBY3RpdmUpIHJldHVybjsKICAgICAgdGhpcy5pc01lbnVBY3RpdmUgPSB0cnVlOwogICAgfSwKICAgIGNsZWFyYWJsZUNhbGxiYWNrOiBmdW5jdGlvbiBjbGVhcmFibGVDYWxsYmFjaygpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB0aGlzLnNldFZhbHVlKHRoaXMubXVsdGlwbGUgPyBbXSA6IG51bGwpOwogICAgICB0aGlzLnNldE1lbnVJbmRleCgtMSk7CiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXM0LiRyZWZzLmlucHV0ICYmIF90aGlzNC4kcmVmcy5pbnB1dC5mb2N1cygpOwogICAgICB9KTsKICAgICAgaWYgKHRoaXMub3Blbk9uQ2xlYXIpIHRoaXMuaXNNZW51QWN0aXZlID0gdHJ1ZTsKICAgIH0sCiAgICBjbG9zZUNvbmRpdGlvbmFsOiBmdW5jdGlvbiBjbG9zZUNvbmRpdGlvbmFsKGUpIHsKICAgICAgaWYgKCF0aGlzLmlzTWVudUFjdGl2ZSkgcmV0dXJuIHRydWU7CiAgICAgIHJldHVybiAhdGhpcy5faXNEZXN0cm95ZWQgJiYgKCAvLyBDbGljayBvcmlnaW5hdGVzIGZyb20gb3V0c2lkZSB0aGUgbWVudSBjb250ZW50CiAgICAgIC8vIE11bHRpcGxlIHNlbGVjdHMgZG9uJ3QgY2xvc2Ugd2hlbiBhbiBpdGVtIGlzIGNsaWNrZWQKICAgICAgIXRoaXMuZ2V0Q29udGVudCgpIHx8ICF0aGlzLmdldENvbnRlbnQoKS5jb250YWlucyhlLnRhcmdldCkpICYmIC8vIENsaWNrIG9yaWdpbmF0ZXMgZnJvbSBvdXRzaWRlIHRoZSBlbGVtZW50CiAgICAgIHRoaXMuJGVsICYmICF0aGlzLiRlbC5jb250YWlucyhlLnRhcmdldCkgJiYgZS50YXJnZXQgIT09IHRoaXMuJGVsOwogICAgfSwKICAgIGZpbHRlckR1cGxpY2F0ZXM6IGZ1bmN0aW9uIGZpbHRlckR1cGxpY2F0ZXMoYXJyKSB7CiAgICAgIHZhciB1bmlxdWVWYWx1ZXMgPSBuZXcgTWFwKCk7CgogICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgYXJyLmxlbmd0aDsgKytpbmRleCkgewogICAgICAgIHZhciBpdGVtID0gYXJyW2luZGV4XTsgLy8gRG8gbm90IGRlZHVwbGljYXRlIGhlYWRlcnMgb3IgZGl2aWRlcnMgKCMxMjUxNykKCiAgICAgICAgaWYgKGl0ZW0uaGVhZGVyIHx8IGl0ZW0uZGl2aWRlcikgewogICAgICAgICAgdW5pcXVlVmFsdWVzLnNldChpdGVtLCBpdGVtKTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdmFyIHZhbCA9IHRoaXMuZ2V0VmFsdWUoaXRlbSk7IC8vIFRPRE86IGNvbXBhcmF0b3IKCiAgICAgICAgIXVuaXF1ZVZhbHVlcy5oYXModmFsKSAmJiB1bmlxdWVWYWx1ZXMuc2V0KHZhbCwgaXRlbSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBBcnJheS5mcm9tKHVuaXF1ZVZhbHVlcy52YWx1ZXMoKSk7CiAgICB9LAogICAgZmluZEV4aXN0aW5nSW5kZXg6IGZ1bmN0aW9uIGZpbmRFeGlzdGluZ0luZGV4KGl0ZW0pIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB2YXIgaXRlbVZhbHVlID0gdGhpcy5nZXRWYWx1ZShpdGVtKTsKICAgICAgcmV0dXJuICh0aGlzLmludGVybmFsVmFsdWUgfHwgW10pLmZpbmRJbmRleChmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiBfdGhpczUudmFsdWVDb21wYXJhdG9yKF90aGlzNS5nZXRWYWx1ZShpKSwgaXRlbVZhbHVlKTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0Q29udGVudDogZnVuY3Rpb24gZ2V0Q29udGVudCgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHJlZnMubWVudSAmJiB0aGlzLiRyZWZzLm1lbnUuJHJlZnMuY29udGVudDsKICAgIH0sCiAgICBnZW5DaGlwU2VsZWN0aW9uOiBmdW5jdGlvbiBnZW5DaGlwU2VsZWN0aW9uKGl0ZW0sIGluZGV4KSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgdmFyIGlzRGlzYWJsZWQgPSB0aGlzLmlzRGlzYWJsZWQgfHwgdGhpcy5nZXREaXNhYmxlZChpdGVtKTsKICAgICAgdmFyIGlzSW50ZXJhY3RpdmUgPSAhaXNEaXNhYmxlZCAmJiB0aGlzLmlzSW50ZXJhY3RpdmU7CiAgICAgIHJldHVybiB0aGlzLiRjcmVhdGVFbGVtZW50KFZDaGlwLCB7CiAgICAgICAgc3RhdGljQ2xhc3M6ICd2LWNoaXAtLXNlbGVjdCcsCiAgICAgICAgYXR0cnM6IHsKICAgICAgICAgIHRhYmluZGV4OiAtMQogICAgICAgIH0sCiAgICAgICAgcHJvcHM6IHsKICAgICAgICAgIGNsb3NlOiB0aGlzLmRlbGV0YWJsZUNoaXBzICYmIGlzSW50ZXJhY3RpdmUsCiAgICAgICAgICBkaXNhYmxlZDogaXNEaXNhYmxlZCwKICAgICAgICAgIGlucHV0VmFsdWU6IGluZGV4ID09PSB0aGlzLnNlbGVjdGVkSW5kZXgsCiAgICAgICAgICBzbWFsbDogdGhpcy5zbWFsbENoaXBzCiAgICAgICAgfSwKICAgICAgICBvbjogewogICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uIGNsaWNrKGUpIHsKICAgICAgICAgICAgaWYgKCFpc0ludGVyYWN0aXZlKSByZXR1cm47CiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgIF90aGlzNi5zZWxlY3RlZEluZGV4ID0gaW5kZXg7CiAgICAgICAgICB9LAogICAgICAgICAgJ2NsaWNrOmNsb3NlJzogZnVuY3Rpb24gY2xpY2tDbG9zZSgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzNi5vbkNoaXBJbnB1dChpdGVtKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGtleTogSlNPTi5zdHJpbmdpZnkodGhpcy5nZXRWYWx1ZShpdGVtKSkKICAgICAgfSwgdGhpcy5nZXRUZXh0KGl0ZW0pKTsKICAgIH0sCiAgICBnZW5Db21tYVNlbGVjdGlvbjogZnVuY3Rpb24gZ2VuQ29tbWFTZWxlY3Rpb24oaXRlbSwgaW5kZXgsIGxhc3QpIHsKICAgICAgdmFyIGNvbG9yID0gaW5kZXggPT09IHRoaXMuc2VsZWN0ZWRJbmRleCAmJiB0aGlzLmNvbXB1dGVkQ29sb3I7CiAgICAgIHZhciBpc0Rpc2FibGVkID0gdGhpcy5pc0Rpc2FibGVkIHx8IHRoaXMuZ2V0RGlzYWJsZWQoaXRlbSk7CiAgICAgIHJldHVybiB0aGlzLiRjcmVhdGVFbGVtZW50KCdkaXYnLCB0aGlzLnNldFRleHRDb2xvcihjb2xvciwgewogICAgICAgIHN0YXRpY0NsYXNzOiAndi1zZWxlY3RfX3NlbGVjdGlvbiB2LXNlbGVjdF9fc2VsZWN0aW9uLS1jb21tYScsCiAgICAgICAgImNsYXNzIjogewogICAgICAgICAgJ3Ytc2VsZWN0X19zZWxlY3Rpb24tLWRpc2FibGVkJzogaXNEaXNhYmxlZAogICAgICAgIH0sCiAgICAgICAga2V5OiBKU09OLnN0cmluZ2lmeSh0aGlzLmdldFZhbHVlKGl0ZW0pKQogICAgICB9KSwgIiIuY29uY2F0KHRoaXMuZ2V0VGV4dChpdGVtKSkuY29uY2F0KGxhc3QgPyAnJyA6ICcsICcpKTsKICAgIH0sCiAgICBnZW5EZWZhdWx0U2xvdDogZnVuY3Rpb24gZ2VuRGVmYXVsdFNsb3QoKSB7CiAgICAgIHZhciBzZWxlY3Rpb25zID0gdGhpcy5nZW5TZWxlY3Rpb25zKCk7CiAgICAgIHZhciBpbnB1dCA9IHRoaXMuZ2VuSW5wdXQoKTsgLy8gSWYgdGhlIHJldHVybiBpcyBhbiBlbXB0eSBhcnJheQogICAgICAvLyBwdXNoIHRoZSBpbnB1dAoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoc2VsZWN0aW9ucykpIHsKICAgICAgICBzZWxlY3Rpb25zLnB1c2goaW5wdXQpOyAvLyBPdGhlcndpc2UgcHVzaCBpdCBpbnRvIGNoaWxkcmVuCiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2VsZWN0aW9ucy5jaGlsZHJlbiA9IHNlbGVjdGlvbnMuY2hpbGRyZW4gfHwgW107CiAgICAgICAgc2VsZWN0aW9ucy5jaGlsZHJlbi5wdXNoKGlucHV0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIFt0aGlzLmdlbkZpZWxkc2V0KCksIHRoaXMuJGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsKICAgICAgICBzdGF0aWNDbGFzczogJ3Ytc2VsZWN0X19zbG90JywKICAgICAgICBkaXJlY3RpdmVzOiB0aGlzLmRpcmVjdGl2ZXMKICAgICAgfSwgW3RoaXMuZ2VuTGFiZWwoKSwgdGhpcy5wcmVmaXggPyB0aGlzLmdlbkFmZml4KCdwcmVmaXgnKSA6IG51bGwsIHNlbGVjdGlvbnMsIHRoaXMuc3VmZml4ID8gdGhpcy5nZW5BZmZpeCgnc3VmZml4JykgOiBudWxsLCB0aGlzLmdlbkNsZWFySWNvbigpLCB0aGlzLmdlbkljb25TbG90KCksIHRoaXMuZ2VuSGlkZGVuSW5wdXQoKV0pLCB0aGlzLmdlbk1lbnUoKSwgdGhpcy5nZW5Qcm9ncmVzcygpXTsKICAgIH0sCiAgICBnZW5JY29uOiBmdW5jdGlvbiBnZW5JY29uKHR5cGUsIGNiLCBleHRyYURhdGEpIHsKICAgICAgdmFyIGljb24gPSBWSW5wdXQub3B0aW9ucy5tZXRob2RzLmdlbkljb24uY2FsbCh0aGlzLCB0eXBlLCBjYiwgZXh0cmFEYXRhKTsKCiAgICAgIGlmICh0eXBlID09PSAnYXBwZW5kJykgewogICAgICAgIC8vIERvbid0IGFsbG93IHRoZSBkcm9wZG93biBpY29uIHRvIGJlIGZvY3VzZWQKICAgICAgICBpY29uLmNoaWxkcmVuWzBdLmRhdGEgPSBtZXJnZURhdGEoaWNvbi5jaGlsZHJlblswXS5kYXRhLCB7CiAgICAgICAgICBhdHRyczogewogICAgICAgICAgICB0YWJpbmRleDogaWNvbi5jaGlsZHJlblswXS5jb21wb25lbnRPcHRpb25zLmxpc3RlbmVycyAmJiAnLTEnLAogICAgICAgICAgICAnYXJpYS1oaWRkZW4nOiAndHJ1ZScsCiAgICAgICAgICAgICdhcmlhLWxhYmVsJzogdW5kZWZpbmVkCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBpY29uOwogICAgfSwKICAgIGdlbklucHV0OiBmdW5jdGlvbiBnZW5JbnB1dCgpIHsKICAgICAgdmFyIGlucHV0ID0gVlRleHRGaWVsZC5vcHRpb25zLm1ldGhvZHMuZ2VuSW5wdXQuY2FsbCh0aGlzKTsKICAgICAgZGVsZXRlIGlucHV0LmRhdGEuYXR0cnMubmFtZTsKICAgICAgaW5wdXQuZGF0YSA9IG1lcmdlRGF0YShpbnB1dC5kYXRhLCB7CiAgICAgICAgZG9tUHJvcHM6IHsKICAgICAgICAgIHZhbHVlOiBudWxsCiAgICAgICAgfSwKICAgICAgICBhdHRyczogewogICAgICAgICAgcmVhZG9ubHk6IHRydWUsCiAgICAgICAgICB0eXBlOiAndGV4dCcsCiAgICAgICAgICAnYXJpYS1yZWFkb25seSc6IFN0cmluZyh0aGlzLmlzUmVhZG9ubHkpLAogICAgICAgICAgJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCc6IGdldE9iamVjdFZhbHVlQnlQYXRoKHRoaXMuJHJlZnMubWVudSwgJ2FjdGl2ZVRpbGUuaWQnKSwKICAgICAgICAgIGF1dG9jb21wbGV0ZTogZ2V0T2JqZWN0VmFsdWVCeVBhdGgoaW5wdXQuZGF0YSwgJ2F0dHJzLmF1dG9jb21wbGV0ZScsICdvZmYnKSwKICAgICAgICAgIHBsYWNlaG9sZGVyOiAhdGhpcy5pc0RpcnR5ICYmICh0aGlzLnBlcnNpc3RlbnRQbGFjZWhvbGRlciB8fCB0aGlzLmlzRm9jdXNlZCB8fCAhdGhpcy5oYXNMYWJlbCkgPyB0aGlzLnBsYWNlaG9sZGVyIDogdW5kZWZpbmVkCiAgICAgICAgfSwKICAgICAgICBvbjogewogICAgICAgICAga2V5cHJlc3M6IHRoaXMub25LZXlQcmVzcwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiBpbnB1dDsKICAgIH0sCiAgICBnZW5IaWRkZW5JbnB1dDogZnVuY3Rpb24gZ2VuSGlkZGVuSW5wdXQoKSB7CiAgICAgIHJldHVybiB0aGlzLiRjcmVhdGVFbGVtZW50KCdpbnB1dCcsIHsKICAgICAgICBkb21Qcm9wczogewogICAgICAgICAgdmFsdWU6IHRoaXMubGF6eVZhbHVlCiAgICAgICAgfSwKICAgICAgICBhdHRyczogewogICAgICAgICAgdHlwZTogJ2hpZGRlbicsCiAgICAgICAgICBuYW1lOiB0aGlzLmF0dHJzJC5uYW1lCiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBnZW5JbnB1dFNsb3Q6IGZ1bmN0aW9uIGdlbklucHV0U2xvdCgpIHsKICAgICAgdmFyIHJlbmRlciA9IFZUZXh0RmllbGQub3B0aW9ucy5tZXRob2RzLmdlbklucHV0U2xvdC5jYWxsKHRoaXMpOwogICAgICByZW5kZXIuZGF0YS5hdHRycyA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgcmVuZGVyLmRhdGEuYXR0cnMpLCB7fSwgewogICAgICAgIHJvbGU6ICdidXR0b24nLAogICAgICAgICdhcmlhLWhhc3BvcHVwJzogJ2xpc3Rib3gnLAogICAgICAgICdhcmlhLWV4cGFuZGVkJzogU3RyaW5nKHRoaXMuaXNNZW51QWN0aXZlKSwKICAgICAgICAnYXJpYS1vd25zJzogdGhpcy5jb21wdXRlZE93bnMKICAgICAgfSk7CiAgICAgIHJldHVybiByZW5kZXI7CiAgICB9LAogICAgZ2VuTGlzdDogZnVuY3Rpb24gZ2VuTGlzdCgpIHsKICAgICAgLy8gSWYgdGhlcmUncyBubyBzbG90cywgd2UgY2FuIHVzZSBhIGNhY2hlZCBWTm9kZSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlCiAgICAgIGlmICh0aGlzLiRzbG90c1snbm8tZGF0YSddIHx8IHRoaXMuJHNsb3RzWydwcmVwZW5kLWl0ZW0nXSB8fCB0aGlzLiRzbG90c1snYXBwZW5kLWl0ZW0nXSkgewogICAgICAgIHJldHVybiB0aGlzLmdlbkxpc3RXaXRoU2xvdCgpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLnN0YXRpY0xpc3Q7CiAgICAgIH0KICAgIH0sCiAgICBnZW5MaXN0V2l0aFNsb3Q6IGZ1bmN0aW9uIGdlbkxpc3RXaXRoU2xvdCgpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICB2YXIgc2xvdHMgPSBbJ3ByZXBlbmQtaXRlbScsICduby1kYXRhJywgJ2FwcGVuZC1pdGVtJ10uZmlsdGVyKGZ1bmN0aW9uIChzbG90TmFtZSkgewogICAgICAgIHJldHVybiBfdGhpczcuJHNsb3RzW3Nsb3ROYW1lXTsKICAgICAgfSkubWFwKGZ1bmN0aW9uIChzbG90TmFtZSkgewogICAgICAgIHJldHVybiBfdGhpczcuJGNyZWF0ZUVsZW1lbnQoJ3RlbXBsYXRlJywgewogICAgICAgICAgc2xvdDogc2xvdE5hbWUKICAgICAgICB9LCBfdGhpczcuJHNsb3RzW3Nsb3ROYW1lXSk7CiAgICAgIH0pOyAvLyBSZXF1aXJlcyBkZXN0cnVjdHVyaW5nIGR1ZSB0byBWdWUKICAgICAgLy8gbW9kaWZ5aW5nIHRoZSBgb25gIHByb3BlcnR5IHdoZW4gcGFzc2VkCiAgICAgIC8vIGFzIGEgcmVmZXJlbmNlZCBvYmplY3QKCiAgICAgIHJldHVybiB0aGlzLiRjcmVhdGVFbGVtZW50KFZTZWxlY3RMaXN0LCBfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLmxpc3REYXRhKSwgc2xvdHMpOwogICAgfSwKICAgIGdlbk1lbnU6IGZ1bmN0aW9uIGdlbk1lbnUoKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgdmFyIHByb3BzID0gdGhpcy4kX21lbnVQcm9wczsKICAgICAgcHJvcHMuYWN0aXZhdG9yID0gdGhpcy4kcmVmc1snaW5wdXQtc2xvdCddOyAvLyBBdHRhY2ggdG8gcm9vdCBlbCBzbyB0aGF0CiAgICAgIC8vIG1lbnUgY292ZXJzIHByZXBlbmQvYXBwZW5kIGljb25zCgogICAgICBpZiAoIC8vIFRPRE86IG1ha2UgdGhpcyBhIGNvbXB1dGVkIHByb3BlcnR5IG9yIGhlbHBlciBvciBzb21ldGhpbmcKICAgICAgdGhpcy5hdHRhY2ggPT09ICcnIHx8IC8vIElmIHVzZWQgYXMgYSBib29sZWFuIHByb3AgKDx2LW1lbnUgYXR0YWNoPikKICAgICAgdGhpcy5hdHRhY2ggPT09IHRydWUgfHwgLy8gSWYgYm91bmQgdG8gYSBib29sZWFuICg8di1tZW51IDphdHRhY2g9InRydWUiPikKICAgICAgdGhpcy5hdHRhY2ggPT09ICdhdHRhY2gnIC8vIElmIGJvdW5kIGFzIGJvb2xlYW4gcHJvcCBpbiBwdWcgKHYtbWVudShhdHRhY2gpKQogICAgICApIHsKICAgICAgICAgIHByb3BzLmF0dGFjaCA9IHRoaXMuJGVsOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgcHJvcHMuYXR0YWNoID0gdGhpcy5hdHRhY2g7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLiRjcmVhdGVFbGVtZW50KFZNZW51LCB7CiAgICAgICAgYXR0cnM6IHsKICAgICAgICAgIHJvbGU6IHVuZGVmaW5lZAogICAgICAgIH0sCiAgICAgICAgcHJvcHM6IHByb3BzLAogICAgICAgIG9uOiB7CiAgICAgICAgICBpbnB1dDogZnVuY3Rpb24gaW5wdXQodmFsKSB7CiAgICAgICAgICAgIF90aGlzOC5pc01lbnVBY3RpdmUgPSB2YWw7CiAgICAgICAgICAgIF90aGlzOC5pc0ZvY3VzZWQgPSB2YWw7CiAgICAgICAgICB9LAogICAgICAgICAgc2Nyb2xsOiB0aGlzLm9uU2Nyb2xsCiAgICAgICAgfSwKICAgICAgICByZWY6ICdtZW51JwogICAgICB9LCBbdGhpcy5nZW5MaXN0KCldKTsKICAgIH0sCiAgICBnZW5TZWxlY3Rpb25zOiBmdW5jdGlvbiBnZW5TZWxlY3Rpb25zKCkgewogICAgICB2YXIgbGVuZ3RoID0gdGhpcy5zZWxlY3RlZEl0ZW1zLmxlbmd0aDsKICAgICAgdmFyIGNoaWxkcmVuID0gbmV3IEFycmF5KGxlbmd0aCk7CiAgICAgIHZhciBnZW5TZWxlY3Rpb247CgogICAgICBpZiAodGhpcy4kc2NvcGVkU2xvdHMuc2VsZWN0aW9uKSB7CiAgICAgICAgZ2VuU2VsZWN0aW9uID0gdGhpcy5nZW5TbG90U2VsZWN0aW9uOwogICAgICB9IGVsc2UgaWYgKHRoaXMuaGFzQ2hpcHMpIHsKICAgICAgICBnZW5TZWxlY3Rpb24gPSB0aGlzLmdlbkNoaXBTZWxlY3Rpb247CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZ2VuU2VsZWN0aW9uID0gdGhpcy5nZW5Db21tYVNlbGVjdGlvbjsKICAgICAgfQoKICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7CiAgICAgICAgY2hpbGRyZW5bbGVuZ3RoXSA9IGdlblNlbGVjdGlvbih0aGlzLnNlbGVjdGVkSXRlbXNbbGVuZ3RoXSwgbGVuZ3RoLCBsZW5ndGggPT09IGNoaWxkcmVuLmxlbmd0aCAtIDEpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudCgnZGl2JywgewogICAgICAgIHN0YXRpY0NsYXNzOiAndi1zZWxlY3RfX3NlbGVjdGlvbnMnCiAgICAgIH0sIGNoaWxkcmVuKTsKICAgIH0sCiAgICBnZW5TbG90U2VsZWN0aW9uOiBmdW5jdGlvbiBnZW5TbG90U2VsZWN0aW9uKGl0ZW0sIGluZGV4KSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgcmV0dXJuIHRoaXMuJHNjb3BlZFNsb3RzLnNlbGVjdGlvbih7CiAgICAgICAgYXR0cnM6IHsKICAgICAgICAgICJjbGFzcyI6ICd2LWNoaXAtLXNlbGVjdCcKICAgICAgICB9LAogICAgICAgIHBhcmVudDogdGhpcywKICAgICAgICBpdGVtOiBpdGVtLAogICAgICAgIGluZGV4OiBpbmRleCwKICAgICAgICBzZWxlY3Q6IGZ1bmN0aW9uIHNlbGVjdChlKSB7CiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgX3RoaXM5LnNlbGVjdGVkSW5kZXggPSBpbmRleDsKICAgICAgICB9LAogICAgICAgIHNlbGVjdGVkOiBpbmRleCA9PT0gdGhpcy5zZWxlY3RlZEluZGV4LAogICAgICAgIGRpc2FibGVkOiAhdGhpcy5pc0ludGVyYWN0aXZlCiAgICAgIH0pOwogICAgfSwKICAgIGdldE1lbnVJbmRleDogZnVuY3Rpb24gZ2V0TWVudUluZGV4KCkgewogICAgICByZXR1cm4gdGhpcy4kcmVmcy5tZW51ID8gdGhpcy4kcmVmcy5tZW51Lmxpc3RJbmRleCA6IC0xOwogICAgfSwKICAgIGdldERpc2FibGVkOiBmdW5jdGlvbiBnZXREaXNhYmxlZChpdGVtKSB7CiAgICAgIHJldHVybiBnZXRQcm9wZXJ0eUZyb21JdGVtKGl0ZW0sIHRoaXMuaXRlbURpc2FibGVkLCBmYWxzZSk7CiAgICB9LAogICAgZ2V0VGV4dDogZnVuY3Rpb24gZ2V0VGV4dChpdGVtKSB7CiAgICAgIHJldHVybiBnZXRQcm9wZXJ0eUZyb21JdGVtKGl0ZW0sIHRoaXMuaXRlbVRleHQsIGl0ZW0pOwogICAgfSwKICAgIGdldFZhbHVlOiBmdW5jdGlvbiBnZXRWYWx1ZShpdGVtKSB7CiAgICAgIHJldHVybiBnZXRQcm9wZXJ0eUZyb21JdGVtKGl0ZW0sIHRoaXMuaXRlbVZhbHVlLCB0aGlzLmdldFRleHQoaXRlbSkpOwogICAgfSwKICAgIG9uQmx1cjogZnVuY3Rpb24gb25CbHVyKGUpIHsKICAgICAgZSAmJiB0aGlzLiRlbWl0KCdibHVyJywgZSk7CiAgICB9LAogICAgb25DaGlwSW5wdXQ6IGZ1bmN0aW9uIG9uQ2hpcElucHV0KGl0ZW0pIHsKICAgICAgaWYgKHRoaXMubXVsdGlwbGUpIHRoaXMuc2VsZWN0SXRlbShpdGVtKTtlbHNlIHRoaXMuc2V0VmFsdWUobnVsbCk7IC8vIElmIGFsbCBpdGVtcyBoYXZlIGJlZW4gZGVsZXRlZCwKICAgICAgLy8gb3BlbiBgdi1tZW51YAoKICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJdGVtcy5sZW5ndGggPT09IDApIHsKICAgICAgICB0aGlzLmlzTWVudUFjdGl2ZSA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc01lbnVBY3RpdmUgPSBmYWxzZTsKICAgICAgfQoKICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gLTE7CiAgICB9LAogICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhlKSB7CiAgICAgIGlmICghdGhpcy5pc0ludGVyYWN0aXZlKSByZXR1cm47CgogICAgICBpZiAoIXRoaXMuaXNBcHBlbmRJbm5lcihlLnRhcmdldCkpIHsKICAgICAgICB0aGlzLmlzTWVudUFjdGl2ZSA9IHRydWU7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5pc0ZvY3VzZWQpIHsKICAgICAgICB0aGlzLmlzRm9jdXNlZCA9IHRydWU7CiAgICAgICAgdGhpcy4kZW1pdCgnZm9jdXMnKTsKICAgICAgfQoKICAgICAgdGhpcy4kZW1pdCgnY2xpY2snLCBlKTsKICAgIH0sCiAgICBvbkVzY0Rvd246IGZ1bmN0aW9uIG9uRXNjRG93bihlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKCiAgICAgIGlmICh0aGlzLmlzTWVudUFjdGl2ZSkgewogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgdGhpcy5pc01lbnVBY3RpdmUgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIG9uS2V5UHJlc3M6IGZ1bmN0aW9uIG9uS2V5UHJlc3MoZSkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICBpZiAodGhpcy5tdWx0aXBsZSB8fCAhdGhpcy5pc0ludGVyYWN0aXZlIHx8IHRoaXMuZGlzYWJsZUxvb2t1cCkgcmV0dXJuOwogICAgICB2YXIgS0VZQk9BUkRfTE9PS1VQX1RIUkVTSE9MRCA9IDEwMDA7IC8vIG1pbGxpc2Vjb25kcwoKICAgICAgdmFyIG5vdyA9IHBlcmZvcm1hbmNlLm5vdygpOwoKICAgICAgaWYgKG5vdyAtIHRoaXMua2V5Ym9hcmRMb29rdXBMYXN0VGltZSA+IEtFWUJPQVJEX0xPT0tVUF9USFJFU0hPTEQpIHsKICAgICAgICB0aGlzLmtleWJvYXJkTG9va3VwUHJlZml4ID0gJyc7CiAgICAgIH0KCiAgICAgIHRoaXMua2V5Ym9hcmRMb29rdXBQcmVmaXggKz0gZS5rZXkudG9Mb3dlckNhc2UoKTsKICAgICAgdGhpcy5rZXlib2FyZExvb2t1cExhc3RUaW1lID0gbm93OwogICAgICB2YXIgaW5kZXggPSB0aGlzLmFsbEl0ZW1zLmZpbmRJbmRleChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHZhciB0ZXh0ID0gKF90aGlzMTAuZ2V0VGV4dChpdGVtKSB8fCAnJykudG9TdHJpbmcoKTsKICAgICAgICByZXR1cm4gdGV4dC50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoX3RoaXMxMC5rZXlib2FyZExvb2t1cFByZWZpeCk7CiAgICAgIH0pOwogICAgICB2YXIgaXRlbSA9IHRoaXMuYWxsSXRlbXNbaW5kZXhdOwoKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgIHRoaXMubGFzdEl0ZW0gPSBNYXRoLm1heCh0aGlzLmxhc3RJdGVtLCBpbmRleCArIDUpOwogICAgICAgIHRoaXMuc2V0VmFsdWUodGhpcy5yZXR1cm5PYmplY3QgPyBpdGVtIDogdGhpcy5nZXRWYWx1ZShpdGVtKSk7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMTAuJHJlZnMubWVudS5nZXRUaWxlcygpOwogICAgICAgIH0pOwogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMTAuc2V0TWVudUluZGV4KGluZGV4KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIG9uS2V5RG93bjogZnVuY3Rpb24gb25LZXlEb3duKGUpIHsKICAgICAgdmFyIF90aGlzMTEgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuaXNSZWFkb25seSAmJiBlLmtleUNvZGUgIT09IGtleUNvZGVzLnRhYikgcmV0dXJuOwogICAgICB2YXIga2V5Q29kZSA9IGUua2V5Q29kZTsKICAgICAgdmFyIG1lbnUgPSB0aGlzLiRyZWZzLm1lbnU7CiAgICAgIHRoaXMuJGVtaXQoJ2tleWRvd24nLCBlKTsKICAgICAgaWYgKCFtZW51KSByZXR1cm47IC8vIElmIG1lbnUgaXMgYWN0aXZlLCBhbGxvdyBkZWZhdWx0CiAgICAgIC8vIGxpc3RJbmRleCBjaGFuZ2UgZnJvbSBtZW51CgogICAgICBpZiAodGhpcy5pc01lbnVBY3RpdmUgJiYga2V5Q29kZSAhPT0ga2V5Q29kZXMudGFiKSB7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgbWVudS5jaGFuZ2VMaXN0SW5kZXgoZSk7CgogICAgICAgICAgX3RoaXMxMS4kZW1pdCgndXBkYXRlOmxpc3QtaW5kZXgnLCBtZW51Lmxpc3RJbmRleCk7CiAgICAgICAgfSk7CiAgICAgIH0gLy8gSWYgZW50ZXIsIHNwYWNlLCBvcGVuIG1lbnUKCgogICAgICBpZiAoW2tleUNvZGVzLmVudGVyLCBrZXlDb2Rlcy5zcGFjZV0uaW5jbHVkZXMoa2V5Q29kZSkpIHRoaXMuYWN0aXZhdGVNZW51KCk7IC8vIElmIG1lbnUgaXMgbm90IGFjdGl2ZSwgdXAvZG93bi9ob21lL2VuZCBjYW4gZG8KICAgICAgLy8gb25lIG9mIDIgdGhpbmdzLiBJZiBtdWx0aXBsZSwgb3BlbnMgdGhlCiAgICAgIC8vIG1lbnUsIGlmIG5vdCwgd2lsbCBjeWNsZSB0aHJvdWdoIGFsbAogICAgICAvLyBhdmFpbGFibGUgb3B0aW9ucwoKICAgICAgaWYgKCF0aGlzLmlzTWVudUFjdGl2ZSAmJiBba2V5Q29kZXMudXAsIGtleUNvZGVzLmRvd24sIGtleUNvZGVzLmhvbWUsIGtleUNvZGVzLmVuZF0uaW5jbHVkZXMoa2V5Q29kZSkpIHJldHVybiB0aGlzLm9uVXBEb3duKGUpOyAvLyBJZiBlc2NhcGUgZGVhY3RpdmF0ZSB0aGUgbWVudQoKICAgICAgaWYgKGtleUNvZGUgPT09IGtleUNvZGVzLmVzYykgcmV0dXJuIHRoaXMub25Fc2NEb3duKGUpOyAvLyBJZiB0YWIgLSBzZWxlY3QgaXRlbSBvciBjbG9zZSBtZW51CgogICAgICBpZiAoa2V5Q29kZSA9PT0ga2V5Q29kZXMudGFiKSByZXR1cm4gdGhpcy5vblRhYkRvd24oZSk7IC8vIElmIHNwYWNlIHByZXZlbnREZWZhdWx0CgogICAgICBpZiAoa2V5Q29kZSA9PT0ga2V5Q29kZXMuc3BhY2UpIHJldHVybiB0aGlzLm9uU3BhY2VEb3duKGUpOwogICAgfSwKICAgIG9uTWVudUFjdGl2ZUNoYW5nZTogZnVuY3Rpb24gb25NZW51QWN0aXZlQ2hhbmdlKHZhbCkgewogICAgICAvLyBJZiBtZW51IGlzIGNsb3NpbmcgYW5kIG11bGl0cGxlCiAgICAgIC8vIG9yIG1lbnVJbmRleCBpcyBhbHJlYWR5IHNldAogICAgICAvLyBza2lwIG1lbnUgaW5kZXggcmVjYWxjdWxhdGlvbgogICAgICBpZiAodGhpcy5tdWx0aXBsZSAmJiAhdmFsIHx8IHRoaXMuZ2V0TWVudUluZGV4KCkgPiAtMSkgcmV0dXJuOwogICAgICB2YXIgbWVudSA9IHRoaXMuJHJlZnMubWVudTsKICAgICAgaWYgKCFtZW51IHx8ICF0aGlzLmlzRGlydHkpIHJldHVybjsgLy8gV2hlbiBtZW51IG9wZW5zLCBzZXQgaW5kZXggb2YgZmlyc3QgYWN0aXZlIGl0ZW0KCiAgICAgIHRoaXMuJHJlZnMubWVudS5nZXRUaWxlcygpOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZW51LnRpbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKG1lbnUudGlsZXNbaV0uZ2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJykgPT09ICd0cnVlJykgewogICAgICAgICAgdGhpcy5zZXRNZW51SW5kZXgoaSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBvbk1vdXNlVXA6IGZ1bmN0aW9uIG9uTW91c2VVcChlKSB7CiAgICAgIHZhciBfdGhpczEyID0gdGhpczsKCiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBzb25hcmpzL25vLWNvbGxhcHNpYmxlLWlmCiAgICAgIGlmICh0aGlzLmhhc01vdXNlRG93biAmJiBlLndoaWNoICE9PSAzICYmIHRoaXMuaXNJbnRlcmFjdGl2ZSkgewogICAgICAgIC8vIElmIGFwcGVuZCBpbm5lciBpcyBwcmVzZW50CiAgICAgICAgLy8gYW5kIHRoZSB0YXJnZXQgaXMgaXRzZWxmCiAgICAgICAgLy8gb3IgaW5zaWRlLCB0b2dnbGUgbWVudQogICAgICAgIGlmICh0aGlzLmlzQXBwZW5kSW5uZXIoZS50YXJnZXQpKSB7CiAgICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpczEyLmlzTWVudUFjdGl2ZSA9ICFfdGhpczEyLmlzTWVudUFjdGl2ZTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgVlRleHRGaWVsZC5vcHRpb25zLm1ldGhvZHMub25Nb3VzZVVwLmNhbGwodGhpcywgZSk7CiAgICB9LAogICAgb25TY3JvbGw6IGZ1bmN0aW9uIG9uU2Nyb2xsKCkgewogICAgICB2YXIgX3RoaXMxMyA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuaXNNZW51QWN0aXZlKSB7CiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczEzLmdldENvbnRlbnQoKS5zY3JvbGxUb3AgPSAwOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0aGlzLmxhc3RJdGVtID4gdGhpcy5jb21wdXRlZEl0ZW1zLmxlbmd0aCkgcmV0dXJuOwogICAgICAgIHZhciBzaG93TW9yZUl0ZW1zID0gdGhpcy5nZXRDb250ZW50KCkuc2Nyb2xsSGVpZ2h0IC0gKHRoaXMuZ2V0Q29udGVudCgpLnNjcm9sbFRvcCArIHRoaXMuZ2V0Q29udGVudCgpLmNsaWVudEhlaWdodCkgPCAyMDA7CgogICAgICAgIGlmIChzaG93TW9yZUl0ZW1zKSB7CiAgICAgICAgICB0aGlzLmxhc3RJdGVtICs9IDIwOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIG9uU3BhY2VEb3duOiBmdW5jdGlvbiBvblNwYWNlRG93bihlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIH0sCiAgICBvblRhYkRvd246IGZ1bmN0aW9uIG9uVGFiRG93bihlKSB7CiAgICAgIHZhciBtZW51ID0gdGhpcy4kcmVmcy5tZW51OwogICAgICBpZiAoIW1lbnUpIHJldHVybjsKICAgICAgdmFyIGFjdGl2ZVRpbGUgPSBtZW51LmFjdGl2ZVRpbGU7IC8vIEFuIGl0ZW0gdGhhdCBpcyBzZWxlY3RlZCBieQogICAgICAvLyBtZW51LWluZGV4IHNob3VsZCB0b2dnbGVkCgogICAgICBpZiAoIXRoaXMubXVsdGlwbGUgJiYgYWN0aXZlVGlsZSAmJiB0aGlzLmlzTWVudUFjdGl2ZSkgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGFjdGl2ZVRpbGUuY2xpY2soKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBJZiB3ZSBtYWtlIGl0IGhlcmUsCiAgICAgICAgLy8gdGhlIHVzZXIgaGFzIG5vIHNlbGVjdGVkIGluZGV4ZXMKICAgICAgICAvLyBhbmQgaXMgcHJvYmFibHkgdGFiYmluZyBvdXQKICAgICAgICB0aGlzLmJsdXIoZSk7CiAgICAgIH0KICAgIH0sCiAgICBvblVwRG93bjogZnVuY3Rpb24gb25VcERvd24oZSkgewogICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7CgogICAgICB2YXIgbWVudSA9IHRoaXMuJHJlZnMubWVudTsKICAgICAgaWYgKCFtZW51KSByZXR1cm47CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsgLy8gTXVsdGlwbGUgc2VsZWN0cyBkbyBub3QgY3ljbGUgdGhlaXIgdmFsdWUKICAgICAgLy8gd2hlbiBwcmVzc2luZyB1cCBvciBkb3duLCBpbnN0ZWFkIGFjdGl2YXRlCiAgICAgIC8vIHRoZSBtZW51CgogICAgICBpZiAodGhpcy5tdWx0aXBsZSkgcmV0dXJuIHRoaXMuYWN0aXZhdGVNZW51KCk7CiAgICAgIHZhciBrZXlDb2RlID0gZS5rZXlDb2RlOyAvLyBDeWNsZSB0aHJvdWdoIGF2YWlsYWJsZSB2YWx1ZXMgdG8gYWNoaWV2ZQogICAgICAvLyBzZWxlY3QgbmF0aXZlIGJlaGF2aW9yCgogICAgICBtZW51LmlzQm9vdGVkID0gdHJ1ZTsKICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7CiAgICAgICAgbWVudS5nZXRUaWxlcygpOwogICAgICAgIGlmICghbWVudS5oYXNDbGlja2FibGVUaWxlcykgcmV0dXJuIF90aGlzMTQuYWN0aXZhdGVNZW51KCk7CgogICAgICAgIHN3aXRjaCAoa2V5Q29kZSkgewogICAgICAgICAgY2FzZSBrZXlDb2Rlcy51cDoKICAgICAgICAgICAgbWVudS5wcmV2VGlsZSgpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIGtleUNvZGVzLmRvd246CiAgICAgICAgICAgIG1lbnUubmV4dFRpbGUoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBrZXlDb2Rlcy5ob21lOgogICAgICAgICAgICBtZW51LmZpcnN0VGlsZSgpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIGtleUNvZGVzLmVuZDoKICAgICAgICAgICAgbWVudS5sYXN0VGlsZSgpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIF90aGlzMTQuc2VsZWN0SXRlbShfdGhpczE0LmFsbEl0ZW1zW190aGlzMTQuZ2V0TWVudUluZGV4KCldKTsKICAgICAgfSk7CiAgICB9LAogICAgc2VsZWN0SXRlbTogZnVuY3Rpb24gc2VsZWN0SXRlbShpdGVtKSB7CiAgICAgIHZhciBfdGhpczE1ID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5tdWx0aXBsZSkgewogICAgICAgIHRoaXMuc2V0VmFsdWUodGhpcy5yZXR1cm5PYmplY3QgPyBpdGVtIDogdGhpcy5nZXRWYWx1ZShpdGVtKSk7CiAgICAgICAgdGhpcy5pc01lbnVBY3RpdmUgPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgaW50ZXJuYWxWYWx1ZSA9ICh0aGlzLmludGVybmFsVmFsdWUgfHwgW10pLnNsaWNlKCk7CiAgICAgICAgdmFyIGkgPSB0aGlzLmZpbmRFeGlzdGluZ0luZGV4KGl0ZW0pOwogICAgICAgIGkgIT09IC0xID8gaW50ZXJuYWxWYWx1ZS5zcGxpY2UoaSwgMSkgOiBpbnRlcm5hbFZhbHVlLnB1c2goaXRlbSk7CiAgICAgICAgdGhpcy5zZXRWYWx1ZShpbnRlcm5hbFZhbHVlLm1hcChmdW5jdGlvbiAoaSkgewogICAgICAgICAgcmV0dXJuIF90aGlzMTUucmV0dXJuT2JqZWN0ID8gaSA6IF90aGlzMTUuZ2V0VmFsdWUoaSk7CiAgICAgICAgfSkpOyAvLyBXaGVuIHNlbGVjdGluZyBtdWx0aXBsZQogICAgICAgIC8vIGFkanVzdCBtZW51IGFmdGVyIGVhY2gKICAgICAgICAvLyBzZWxlY3Rpb24KCiAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMxNS4kcmVmcy5tZW51ICYmIF90aGlzMTUuJHJlZnMubWVudS51cGRhdGVEaW1lbnNpb25zKCk7CiAgICAgICAgfSk7CiAgICAgICAgdmFyIGxpc3RJbmRleCA9IHRoaXMuZ2V0TWVudUluZGV4KCk7CiAgICAgICAgdGhpcy5zZXRNZW51SW5kZXgoLTEpOyAvLyBUaGVyZSBpcyBubyBpdGVtIHRvIHJlLWhpZ2hsaWdodAogICAgICAgIC8vIHdoZW4gc2VsZWN0aW9ucyBhcmUgaGlkZGVuCgogICAgICAgIGlmICh0aGlzLmhpZGVTZWxlY3RlZCkgcmV0dXJuOwogICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczE1LnNldE1lbnVJbmRleChsaXN0SW5kZXgpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgc2V0TWVudUluZGV4OiBmdW5jdGlvbiBzZXRNZW51SW5kZXgoaW5kZXgpIHsKICAgICAgdGhpcy4kcmVmcy5tZW51ICYmICh0aGlzLiRyZWZzLm1lbnUubGlzdEluZGV4ID0gaW5kZXgpOwogICAgfSwKICAgIHNldFNlbGVjdGVkSXRlbXM6IGZ1bmN0aW9uIHNldFNlbGVjdGVkSXRlbXMoKSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKCiAgICAgIHZhciBzZWxlY3RlZEl0ZW1zID0gW107CiAgICAgIHZhciB2YWx1ZXMgPSAhdGhpcy5tdWx0aXBsZSB8fCAhQXJyYXkuaXNBcnJheSh0aGlzLmludGVybmFsVmFsdWUpID8gW3RoaXMuaW50ZXJuYWxWYWx1ZV0gOiB0aGlzLmludGVybmFsVmFsdWU7CgogICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodmFsdWVzKSwKICAgICAgICAgIF9zdGVwOwoKICAgICAgdHJ5IHsKICAgICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcCgpIHsKICAgICAgICAgIHZhciB2YWx1ZSA9IF9zdGVwLnZhbHVlOwoKICAgICAgICAgIHZhciBpbmRleCA9IF90aGlzMTYuYWxsSXRlbXMuZmluZEluZGV4KGZ1bmN0aW9uICh2KSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpczE2LnZhbHVlQ29tcGFyYXRvcihfdGhpczE2LmdldFZhbHVlKHYpLCBfdGhpczE2LmdldFZhbHVlKHZhbHVlKSk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICBpZiAoaW5kZXggPiAtMSkgewogICAgICAgICAgICBzZWxlY3RlZEl0ZW1zLnB1c2goX3RoaXMxNi5hbGxJdGVtc1tpbmRleF0pOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICBfbG9vcCgpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICB9CgogICAgICB0aGlzLnNlbGVjdGVkSXRlbXMgPSBzZWxlY3RlZEl0ZW1zOwogICAgfSwKICAgIHNldFZhbHVlOiBmdW5jdGlvbiBzZXRWYWx1ZSh2YWx1ZSkgewogICAgICBpZiAoIXRoaXMudmFsdWVDb21wYXJhdG9yKHZhbHVlLCB0aGlzLmludGVybmFsVmFsdWUpKSB7CiAgICAgICAgdGhpcy5pbnRlcm5hbFZhbHVlID0gdmFsdWU7CiAgICAgICAgdGhpcy4kZW1pdCgnY2hhbmdlJywgdmFsdWUpOwogICAgICB9CiAgICB9LAogICAgaXNBcHBlbmRJbm5lcjogZnVuY3Rpb24gaXNBcHBlbmRJbm5lcih0YXJnZXQpIHsKICAgICAgLy8gcmV0dXJuIHRydWUgaWYgYXBwZW5kIGlubmVyIGlzIHByZXNlbnQKICAgICAgLy8gYW5kIHRoZSB0YXJnZXQgaXMgaXRzZWxmIG9yIGluc2lkZQogICAgICB2YXIgYXBwZW5kSW5uZXIgPSB0aGlzLiRyZWZzWydhcHBlbmQtaW5uZXInXTsKICAgICAgcmV0dXJuIGFwcGVuZElubmVyICYmIChhcHBlbmRJbm5lciA9PT0gdGFyZ2V0IHx8IGFwcGVuZElubmVyLmNvbnRhaW5zKHRhcmdldCkpOwogICAgfQogIH0KfSk7"},null]}