{"remainingRequest":"/Users/js/Google Drive/_Github/github_upload/eotemp/node_modules/thread-loader/dist/cjs.js!/Users/js/Google Drive/_Github/github_upload/eotemp/node_modules/babel-loader/lib/index.js!/Users/js/Google Drive/_Github/github_upload/eotemp/src/store/modules/features.js","dependencies":[{"path":"/Users/js/Google Drive/_Github/github_upload/eotemp/src/store/modules/features.js","mtime":1624532486000},{"path":"/Users/js/Google Drive/_Github/github_upload/eotemp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/js/Google Drive/_Github/github_upload/eotemp/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/js/Google Drive/_Github/github_upload/eotemp/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIi9Vc2Vycy9qcy9Hb29nbGUgRHJpdmUvX0dpdGh1Yi9naXRodWJfdXBsb2FkL2VvdGVtcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvVXNlcnMvanMvR29vZ2xlIERyaXZlL19HaXRodWIvZ2l0aHViX3VwbG9hZC9lb3RlbXAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIi9Vc2Vycy9qcy9Hb29nbGUgRHJpdmUvX0dpdGh1Yi9naXRodWJfdXBsb2FkL2VvdGVtcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvcnQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZsYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmlzLWFycmF5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29tZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmVudHJpZXMuanMiOwoKLyogZXNsaW50IG5vLXNoYWRvdzogWyJlcnJvciIsIHsgImFsbG93IjogWyJzdGF0ZSIsICJnZXR0ZXJzIl0gfV0gKi8KaW1wb3J0IHsgV2t0IH0gZnJvbSAnd2lja2V0JzsKaW1wb3J0IHsgbGF0TG5nIH0gZnJvbSAnbGVhZmxldCc7CmltcG9ydCBjb3VudHJpZXNKc29uIGZyb20gJ0AvYXNzZXRzL2NvdW50cmllcy5qc29uJzsKdmFyIGdsb2JhbElkQ291bnRlciA9IDA7CnZhciBzdGF0ZSA9IHsKICBhbGxGZWF0dXJlczogW10sCiAgZmVhdHVyZUZpbHRlcnM6IHsKICAgIGNvdW50cmllczogW10sCiAgICBpbmRpY2F0b3JzOiBbXSwKICAgIGluY2x1ZGVBcmNoaXZlZDogZmFsc2UKICB9LAogIHNlbGVjdGVkQXJlYTogbnVsbCwKICByZXN1bHRzQ291bnQ6IHsKICAgIGVjb25vbWljOiAwLAogICAgYWdyaWN1bHR1cmU6IDAsCiAgICBlbnZpcm9ubWVudDogMAogIH0KfTsKdmFyIGdldHRlcnMgPSB7CiAgZ2V0Q291bnRyaWVzOiBmdW5jdGlvbiBnZXRDb3VudHJpZXMoc3RhdGUpIHsKICAgIHJldHVybiBfdG9Db25zdW1hYmxlQXJyYXkobmV3IFNldChbc3RhdGUuYWxsRmVhdHVyZXMuZmlsdGVyKGZ1bmN0aW9uIChmKSB7CiAgICAgIHJldHVybiBzdGF0ZS5mZWF0dXJlRmlsdGVycy5pbmRpY2F0b3JzLmxlbmd0aCA+IDAgPyBzdGF0ZS5mZWF0dXJlRmlsdGVycy5pbmRpY2F0b3JzLmluY2x1ZGVzKGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuaW5kaWNhdG9yKSA6IHRydWU7CiAgICB9KS5tYXAoZnVuY3Rpb24gKGYpIHsKICAgICAgcmV0dXJuIGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuY291bnRyeTsKICAgIH0pXS5mbGF0KDIpKSkuc29ydCgpOwogIH0sCiAgZ2V0SW5kaWNhdG9yczogZnVuY3Rpb24gZ2V0SW5kaWNhdG9ycyhzdGF0ZSwgXywgcm9vdFN0YXRlKSB7CiAgICB2YXIgaW5kaWNhdG9ycyA9IF90b0NvbnN1bWFibGVBcnJheShuZXcgU2V0KFtzdGF0ZS5hbGxGZWF0dXJlcy5maWx0ZXIoZnVuY3Rpb24gKGYpIHsKICAgICAgdmFyIGZpbHRlcmVkOwoKICAgICAgaWYgKHN0YXRlLmZlYXR1cmVGaWx0ZXJzLmNvdW50cmllcy5sZW5ndGggPiAwKSB7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZi5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC5jb3VudHJ5KSkgewogICAgICAgICAgZmlsdGVyZWQgPSBmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmNvdW50cnkuc29tZShmdW5jdGlvbiAoaSkgewogICAgICAgICAgICByZXR1cm4gc3RhdGUuZmVhdHVyZUZpbHRlcnMuY291bnRyaWVzLmluY2x1ZGVzKGkpOwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZpbHRlcmVkID0gc3RhdGUuZmVhdHVyZUZpbHRlcnMuY291bnRyaWVzLmluY2x1ZGVzKGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuY291bnRyeSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKCFzdGF0ZS5mZWF0dXJlRmlsdGVycy5pbmNsdWRlQXJjaGl2ZWQpIHsKICAgICAgICBmaWx0ZXJlZCA9IGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuZGVzY3JpcHRpb24gJiYgIWYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuZGVzY3JpcHRpb24uaW5jbHVkZXMoJyhhcmNoaXZlZCknKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmaWx0ZXJlZCA9IHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmaWx0ZXJlZDsKICAgIH0pLm1hcChmdW5jdGlvbiAoZikgewogICAgICByZXR1cm4gewogICAgICAgIGFyY2hpdmVkOiBmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmRlc2NyaXB0aW9uICYmIGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuZGVzY3JpcHRpb24uaW5jbHVkZXMoJyhhcmNoaXZlZCknKSwKICAgICAgICBjb2RlOiBmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmluZGljYXRvciwKICAgICAgICBpbmRpY2F0b3I6IGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuZGVzY3JpcHRpb24sCiAgICAgICAgImNsYXNzIjogcm9vdFN0YXRlLmNvbmZpZy5iYXNlQ29uZmlnLmluZGljYXRvcnNEZWZpbml0aW9uW2YucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuaW5kaWNhdG9yXVsiY2xhc3MiXSwKICAgICAgICBpbmRpY2F0b3JPdmVyd3JpdGU6IHJvb3RTdGF0ZS5jb25maWcuYmFzZUNvbmZpZy5pbmRpY2F0b3JzRGVmaW5pdGlvbltmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmluZGljYXRvcl0uaW5kaWNhdG9yT3ZlcndyaXRlCiAgICAgIH07CiAgICB9KV0uZmxhdCgyKSkpLnNvcnQoKTsKCiAgICByZXR1cm4gaW5kaWNhdG9yczsKICB9LAogIGdldENvdW50cnlJdGVtczogZnVuY3Rpb24gZ2V0Q291bnRyeUl0ZW1zKHN0YXRlLCBnZXR0ZXJzRykgewogICAgcmV0dXJuIGdldHRlcnNHLmdldENvdW50cmllcy5maWx0ZXIoZnVuY3Rpb24gKGMpIHsKICAgICAgcmV0dXJuIGMgIT09ICdhbGwnOwogICAgfSkubWFwKGZ1bmN0aW9uIChjKSB7CiAgICAgIHZhciBpdGVtID0gY291bnRyaWVzSnNvbi5mZWF0dXJlcy5maW5kKGZ1bmN0aW9uIChmKSB7CiAgICAgICAgcmV0dXJuIGYucHJvcGVydGllcy5hbHBoYTIgPT09IGM7CiAgICAgIH0pOwogICAgICByZXR1cm4gewogICAgICAgIGNvZGU6IGMsCiAgICAgICAgbmFtZTogaXRlbSA/IGl0ZW0ucHJvcGVydGllcy5uYW1lIDogJ1JlZ2lvbmFsJwogICAgICB9OwogICAgfSkuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICByZXR1cm4gYS5uYW1lID4gYi5uYW1lID8gMSA6IC0xOwogICAgfSk7CiAgfSwKICBnZXRGZWF0dXJlczogZnVuY3Rpb24gZ2V0RmVhdHVyZXMoc3RhdGUpIHsKICAgIHZhciBmZWF0dXJlcyA9IHN0YXRlLmFsbEZlYXR1cmVzOwoKICAgIGlmIChzdGF0ZS5mZWF0dXJlRmlsdGVycy5jb3VudHJpZXMubGVuZ3RoID4gMCkgewogICAgICBmZWF0dXJlcyA9IGZlYXR1cmVzLmZpbHRlcihmdW5jdGlvbiAoZikgewogICAgICAgIGlmIChBcnJheS5pc0FycmF5KGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuY291bnRyeSkpIHsKICAgICAgICAgIHJldHVybiBmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmNvdW50cnkuaW5jbHVkZXMoc3RhdGUuZmVhdHVyZUZpbHRlcnMuY291bnRyaWVzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbGluZQogICAgICAgICAgcmV0dXJuIHN0YXRlLmZlYXR1cmVGaWx0ZXJzLmNvdW50cmllcy5pbmNsdWRlcyhmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmNvdW50cnkpIHx8IGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuY2l0eSA9PT0gJ1dvcmxkJzsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIGlmIChzdGF0ZS5mZWF0dXJlRmlsdGVycy5pbmRpY2F0b3JzLmxlbmd0aCA+IDApIHsKICAgICAgZmVhdHVyZXMgPSBmZWF0dXJlcy5maWx0ZXIoZnVuY3Rpb24gKGYpIHsKICAgICAgICByZXR1cm4gc3RhdGUuZmVhdHVyZUZpbHRlcnMuaW5kaWNhdG9ycy5pbmNsdWRlcyhmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmluZGljYXRvcik7CiAgICAgIH0pOwogICAgfQoKICAgIGlmICghc3RhdGUuZmVhdHVyZUZpbHRlcnMuaW5jbHVkZUFyY2hpdmVkKSB7CiAgICAgIGZlYXR1cmVzID0gZmVhdHVyZXMuZmlsdGVyKGZ1bmN0aW9uIChmKSB7CiAgICAgICAgcmV0dXJuIGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QudXBkYXRlRnJlcXVlbmN5ID8gZi5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC51cGRhdGVGcmVxdWVuY3kudG9Mb3dlckNhc2UoKSAhPT0gJ2FyY2hpdmVkJyA6IHRydWU7CiAgICAgIH0pOwogICAgfQoKICAgIGZlYXR1cmVzID0gZmVhdHVyZXMuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICByZXR1cm4gYS5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC5jb3VudHJ5ID4gYi5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC5jb3VudHJ5ID8gMSA6IC0xOwogICAgfSk7CiAgICByZXR1cm4gZmVhdHVyZXM7CiAgfSwKICBnZXRHcm91cGVkRmVhdHVyZXM6IGZ1bmN0aW9uIGdldEdyb3VwZWRGZWF0dXJlcyhzdGF0ZSwgZ2V0dGVycywgcm9vdFN0YXRlKSB7CiAgICB2YXIgYWxsRmVhdHVyZXMgPSBbXTsKCiAgICBpZiAoc3RhdGUuYWxsRmVhdHVyZXMubGVuZ3RoID4gMCkgewogICAgICB2YXIgZ3JvdXBlZEZlYXR1cmVzID0gW107CgogICAgICBpZiAocm9vdFN0YXRlLmNvbmZpZy5hcHBDb25maWcuZmVhdHVyZUdyb3VwaW5nKSB7CiAgICAgICAgcm9vdFN0YXRlLmNvbmZpZy5hcHBDb25maWcuZmVhdHVyZUdyb3VwaW5nLmZvckVhY2goZnVuY3Rpb24gKGZHKSB7CiAgICAgICAgICB2YXIgZmlyc3RGZWF0dXJlID0gZ2V0dGVycy5nZXRGZWF0dXJlcy5maW5kKGZ1bmN0aW9uIChmKSB7CiAgICAgICAgICAgIHJldHVybiAiIi5jb25jYXQoZi5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC5hb2lJRCwgIi0iKS5jb25jYXQoZi5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC5pbmRpY2F0b3IpID09PSBmRy5mZWF0dXJlc1swXTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIGlmIChmaXJzdEZlYXR1cmUpIHsKICAgICAgICAgICAgZ3JvdXBlZEZlYXR1cmVzLnB1c2goZmlyc3RGZWF0dXJlKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdmFyIHJlc3RGZWF0dXJlcyA9IHJvb3RTdGF0ZS5jb25maWcuYXBwQ29uZmlnLmZlYXR1cmVHcm91cGluZyA/IGdldHRlcnMuZ2V0RmVhdHVyZXMuZmlsdGVyKGZ1bmN0aW9uIChmKSB7CiAgICAgICAgdmFyIGxvY2F0aW9uQ29kZSA9ICIiLmNvbmNhdChmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmFvaUlELCAiLSIpLmNvbmNhdChmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmluZGljYXRvcik7CiAgICAgICAgcmV0dXJuICFyb290U3RhdGUuY29uZmlnLmFwcENvbmZpZy5mZWF0dXJlR3JvdXBpbmcuZmluZChmdW5jdGlvbiAoZkcpIHsKICAgICAgICAgIHJldHVybiBmRy5mZWF0dXJlcy5pbmNsdWRlcyhsb2NhdGlvbkNvZGUpOwogICAgICAgIH0pOwogICAgICB9KSA6IGdldHRlcnMuZ2V0RmVhdHVyZXM7CiAgICAgIGFsbEZlYXR1cmVzID0gZ3JvdXBlZEZlYXR1cmVzLmNvbmNhdChyZXN0RmVhdHVyZXMpOwogICAgfQoKICAgIHJldHVybiBhbGxGZWF0dXJlczsKICB9LAogIGdldExhdGVzdFVwZGF0ZTogZnVuY3Rpb24gZ2V0TGF0ZXN0VXBkYXRlKHN0YXRlKSB7CiAgICB2YXIgdGltZXMgPSBzdGF0ZS5hbGxGZWF0dXJlcy5tYXAoZnVuY3Rpb24gKGYpIHsKICAgICAgdmFyIHRpbWUgPSBmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LlRpbWU7CiAgICAgIHZhciBsYXRlc3Q7CgogICAgICBpZiAodGltZSAmJiB0aW1lLmxlbmd0aCA+IDApIHsKICAgICAgICB0aW1lID0gdGltZS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICByZXR1cm4gYSA+IGIgPyAxIDogLTE7CiAgICAgICAgfSk7CiAgICAgICAgbGF0ZXN0ID0gdGltZVt0aW1lLmxlbmd0aCAtIDFdOwogICAgICB9CgogICAgICByZXR1cm4gbGF0ZXN0OwogICAgfSk7CiAgICB2YXIgZmlsdGVyZWQgPSB0aW1lcy5maWx0ZXIoZnVuY3Rpb24gKHQpIHsKICAgICAgcmV0dXJuICEhdDsKICAgIH0pLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgcmV0dXJuIGEgPiBiID8gMSA6IC0xOwogICAgfSk7CiAgICByZXR1cm4gZmlsdGVyZWRbZmlsdGVyZWQubGVuZ3RoIC0gMV07CiAgfQp9Owp2YXIgbXV0YXRpb25zID0gewogIC8vIFNFVF9NQU5VQUxfRkVBVFVSRVMoc3RhdGUsIGZlYXR1cmVzKSB7CiAgLy8gICBzdGF0ZS5hbGxGZWF0dXJlcyA9IHN0YXRlLmFsbEZlYXR1cmVzLmNvbmNhdCgKICAvLyAgICAgZmVhdHVyZXMsCiAgLy8gICAgIHRoaXMuc3RhdGUuY29uZmlnLmJhc2VDb25maWcuZ2xvYmFsSW5kaWNhdG9ycywKICAvLyAgICk7CiAgLy8gfSwKICBBRERfTkVXX0ZFQVRVUkVTOiBmdW5jdGlvbiBBRERfTkVXX0ZFQVRVUkVTKHN0YXRlLCBmZWF0dXJlcykgewogICAgc3RhdGUuYWxsRmVhdHVyZXMgPSBzdGF0ZS5hbGxGZWF0dXJlcy5jb25jYXQoZmVhdHVyZXMpOwogIH0sCiAgLy8gU0VUX0FMTF9EVU1NWV9MT0NBVElPTlMoc3RhdGUsIGZlYXR1cmVzKSB7CiAgLy8gICBzdGF0ZS5hbGxGZWF0dXJlcyA9IHN0YXRlLmFsbEZlYXR1cmVzLmNvbmNhdChmZWF0dXJlcyk7CiAgLy8gfSwKICBJTklUX0ZFQVRVUkVfRklMVEVSOiBmdW5jdGlvbiBJTklUX0ZFQVRVUkVfRklMVEVSKHN0YXRlLCBfcmVmKSB7CiAgICB2YXIgY291bnRyaWVzID0gX3JlZi5jb3VudHJpZXMsCiAgICAgICAgaW5kaWNhdG9ycyA9IF9yZWYuaW5kaWNhdG9yczsKCiAgICBpZiAoY291bnRyaWVzKSB7CiAgICAgIHN0YXRlLmZlYXR1cmVGaWx0ZXJzLmNvdW50cmllcyA9IGNvdW50cmllczsKICAgIH0KCiAgICBpZiAoaW5kaWNhdG9ycykgewogICAgICBzdGF0ZS5mZWF0dXJlRmlsdGVycy5pbmRpY2F0b3JzID0gaW5kaWNhdG9yczsKICAgIH0KICB9LAogIFNFVF9GRUFUVVJFX0ZJTFRFUjogZnVuY3Rpb24gU0VUX0ZFQVRVUkVfRklMVEVSKHN0YXRlLCBvcHRpb25zKSB7CiAgICBpZiAoIW9wdGlvbnMpIHJldHVybjsKCiAgICB2YXIgaGFzRmVhdHVyZSA9IGZ1bmN0aW9uIGhhc0ZlYXR1cmUoZikgewogICAgICByZXR1cm4gT2JqZWN0LmtleXMob3B0aW9ucykuaW5jbHVkZXMoZik7CiAgICB9OwoKICAgIGlmIChoYXNGZWF0dXJlKCdjb3VudHJpZXMnKSkgewogICAgICBzdGF0ZS5mZWF0dXJlRmlsdGVycy5jb3VudHJpZXMgPSBvcHRpb25zLmNvdW50cmllczsKICAgIH0KCiAgICBpZiAoaGFzRmVhdHVyZSgnaW5kaWNhdG9ycycpKSB7CiAgICAgIHN0YXRlLmZlYXR1cmVGaWx0ZXJzLmluZGljYXRvcnMgPSBvcHRpb25zLmluZGljYXRvcnM7CiAgICB9CgogICAgaWYgKGhhc0ZlYXR1cmUoJ2luY2x1ZGVBcmNoaXZlZCcpKSB7CiAgICAgIHN0YXRlLmZlYXR1cmVGaWx0ZXJzLmluY2x1ZGVBcmNoaXZlZCA9IG9wdGlvbnMuaW5jbHVkZUFyY2hpdmVkOwogICAgfQogIH0sCiAgQUREX1JFU1VMVFNfQ09VTlQ6IGZ1bmN0aW9uIEFERF9SRVNVTFRTX0NPVU5UKHN0YXRlLCBfcmVmMikgewogICAgdmFyIHR5cGUgPSBfcmVmMi50eXBlLAogICAgICAgIGNvdW50ID0gX3JlZjIuY291bnQ7CiAgICBzdGF0ZS5yZXN1bHRzQ291bnRbdHlwZV0gKz0gY291bnQ7CiAgfSwKICBTRVRfU0VMRUNURURfQVJFQTogZnVuY3Rpb24gU0VUX1NFTEVDVEVEX0FSRUEoc3RhdGUsIGFyZWEpIHsKICAgIHN0YXRlLnNlbGVjdGVkQXJlYSA9IGFyZWE7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICBsb2FkQWxsRW5kcG9pbnRzOiBmdW5jdGlvbiBsb2FkQWxsRW5kcG9pbnRzKF9yZWYzKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBjb21taXQsIHJvb3RTdGF0ZSwgYWxsRmVhdHVyZXMsIGVuZHBvaW50cywgZXAsIHVybCwgRiwgZW5kUG9pbnRJZHgsIGR1bW15RmVhdHVyZXM7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmMy5jb21taXQsIHJvb3RTdGF0ZSA9IF9yZWYzLnJvb3RTdGF0ZTsKICAgICAgICAgICAgICBhbGxGZWF0dXJlcyA9IFtdOwogICAgICAgICAgICAgIGVuZHBvaW50cyA9IHJvb3RTdGF0ZS5jb25maWcuYmFzZUNvbmZpZy5kYXRhRW5kcG9pbnRzOwogICAgICAgICAgICAgIGVwID0gMDsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBpZiAoIShlcCA8IGVuZHBvaW50cy5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjY7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGVuZHBvaW50c1tlcF0sICd0eXBlJykpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMzsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdXJsID0gZW5kcG9pbnRzW2VwXS5wcm92aWRlcjsKCiAgICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlbmRwb2ludHNbZXBdLCAnbG9jYXRpb25TdWZmaXgnKSkgewogICAgICAgICAgICAgICAgdXJsICs9IGVuZHBvaW50c1tlcF0ubG9jYXRpb25TdWZmaXg7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBGID0gdm9pZCAwOwogICAgICAgICAgICAgIGVuZFBvaW50SWR4ID0gZXA7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBlbmRwb2ludHNbZXBdLnR5cGU7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IF9jb250ZXh0LnQwID09PSAnZ2VvZGInID8gMTMgOiBfY29udGV4dC50MCA9PT0gJ2VveCcgPyAxNyA6IDIxOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmRpc3BhdGNoKCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCiAgICAgICAgICAgICAgJ2ZlYXR1cmVzL2xvYWRHZW9EQkVuZHBvaW50JywgewogICAgICAgICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgICAgICAgICBlbmRQb2ludElkeDogZW5kUG9pbnRJZHgKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgRiA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgiYnJlYWsiLCAyMik7CgogICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxOTsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZGlzcGF0Y2goIC8vIGVzbGludC1kaXNhYmxlLWxpbmUKICAgICAgICAgICAgICAnZmVhdHVyZXMvbG9hZEVPWEVuZHBvaW50JywgewogICAgICAgICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgICAgICAgICBlbmRQb2ludElkeDogZW5kUG9pbnRJZHgKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgRiA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgiYnJlYWsiLCAyMik7CgogICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFbmRwb2ludCB0eXBlIHVua25vd24nKTsKCiAgICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgICAgYWxsRmVhdHVyZXMgPSBhbGxGZWF0dXJlcy5jb25jYXQoRik7CgogICAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICAgIGVwICs9IDE7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDI2OgogICAgICAgICAgICAgIC8vIFRoZW4sIGFkZCB0aGUgaGFyZGNvZGVkIGZlYXR1cmVzCiAgICAgICAgICAgICAgYWxsRmVhdHVyZXMgPSBhbGxGZWF0dXJlcy5jb25jYXQocm9vdFN0YXRlLmNvbmZpZy5iYXNlQ29uZmlnLmdsb2JhbEluZGljYXRvcnMpOyAvLyBUaGVuLCBpZiBhcHBsaWNhYmxlLCBhZGQgdGhlIGR1bW15IGZlYXR1cmVzCgogICAgICAgICAgICAgIGlmICghcm9vdFN0YXRlLmNvbmZpZy5hcHBDb25maWcuZGlzcGxheUR1bW15TG9jYXRpb25zKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzMDsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZGlzcGF0Y2goJ2ZlYXR1cmVzL2xvYWREdW1teUxvY2F0aW9ucycpOwoKICAgICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgICBkdW1teUZlYXR1cmVzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBhbGxGZWF0dXJlcyA9IGFsbEZlYXR1cmVzLmNvbmNhdChkdW1teUZlYXR1cmVzKTsKCiAgICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgICAgY29tbWl0KCdBRERfTkVXX0ZFQVRVUkVTJywgYWxsRmVhdHVyZXMpOwoKICAgICAgICAgICAgY2FzZSAzMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkoKTsKICB9LAogIGxvYWRFT1hFbmRwb2ludDogZnVuY3Rpb24gbG9hZEVPWEVuZHBvaW50KF9yZWY0LCBfcmVmNSkgewogICAgdmFyIHJvb3RTdGF0ZSA9IF9yZWY0LnJvb3RTdGF0ZSwKICAgICAgICBjb21taXQgPSBfcmVmNC5jb21taXQ7CiAgICB2YXIgdXJsID0gX3JlZjUudXJsLAogICAgICAgIGVuZFBvaW50SWR4ID0gX3JlZjUuZW5kUG9pbnRJZHg7CiAgICByZXR1cm4gZmV0Y2godXJsLCB7CiAgICAgIGNyZWRlbnRpYWxzOiAnc2FtZS1vcmlnaW4nCiAgICB9KS50aGVuKGZ1bmN0aW9uIChyKSB7CiAgICAgIHJldHVybiByLmpzb24oKTsKICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgdmFyIGZlYXR1cmVzID0gW107CiAgICAgIHZhciBwTSA9IHsKICAgICAgICBhb2k6ICdhb2knLAogICAgICAgIGFvaUlEOiAnYW9pSUQnLAogICAgICAgIGxhc3RDb2xvckNvZGU6ICdsYXN0Q29sb3JDb2RlJywKICAgICAgICBjb3VudHJ5OiAnY291bnRyeScsCiAgICAgICAgaW5kaWNhdG9yOiAnaW5kaWNhdG9yJywKICAgICAgICBsYXN0SW5kaWNhdG9yVmFsdWU6ICdsYXN0SW5kaWNhdG9yVmFsdWUnLAogICAgICAgIGxhc3RUaW1lOiAnbGFzdFRpbWUnLAogICAgICAgIGxhc3RNZWFzdXJlbWVudDogJ2xhc3RNZWFzdXJlbWVudCcsCiAgICAgICAgc2l0ZU5hbWU6ICdzaXRlTmFtZScsCiAgICAgICAgc3ViQW9pOiAnc3ViQW9pJywKICAgICAgICBjaXR5OiAnY2l0eScsCiAgICAgICAgZGVzY3JpcHRpb246ICdkZXNjcmlwdGlvbicsCiAgICAgICAgcmVnaW9uOiAncmVnaW9uJywKICAgICAgICBpbmRpY2F0b3JOYW1lOiAnaW5kaWNhdG9yTmFtZScsCiAgICAgICAgbGFzdFJlZmVyZW5jZVZhbHVlOiAnbGFzdFJlZmVyZW5jZVZhbHVlJywKICAgICAgICBsYXN0UmVmZXJlbmNlVGltZTogJ2xhc3RSZWZlcmVuY2VUaW1lJywKICAgICAgICB5QXhpczogJ3lBeGlzJywKICAgICAgICB1cGRhdGVGcmVxdWVuY3k6ICd1cGRhdGVGcmVxdWVuY3knCiAgICAgIH07CiAgICAgIGNvbW1pdCgnQUREX1JFU1VMVFNfQ09VTlQnLCB7CiAgICAgICAgdHlwZTogcm9vdFN0YXRlLmNvbmZpZy5iYXNlQ29uZmlnLmluZGljYXRvcnNEZWZpbml0aW9uW2RhdGFbMF1bcE0uaW5kaWNhdG9yXV1bImNsYXNzIl0sCiAgICAgICAgY291bnQ6IGRhdGEubGVuZ3RoIC8vIGluZGl2aWR1YWwgbWVhc3VyZW1lbnRzCgogICAgICB9KTsgLy8gb25seSBjb250aW51ZSBpZiBhb2kgY29sdW1uIGlzIHByZXNlbnQKCiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZGF0YVswXSwgcE0uYW9pKSkgewogICAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgd2t0ID0gbmV3IFdrdCgpOwogICAgICAgICAgdmFyIGZlYXR1cmVPYmpzID0ge307CgogICAgICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AocnIpIHsKICAgICAgICAgICAgLy8gQWdncmVnYXRlIGRhdGEgYmFzZWQgb24gbG9jYXRpb24KICAgICAgICAgICAgdmFyIHVuaXF1ZUtleSA9ICIiLmNvbmNhdChkYXRhW3JyXVtwTS5hb2ldLCAiXyIpLmNvbmNhdChkYXRhW3JyXVtwTS5pbmRpY2F0b3JdKTsKCiAgICAgICAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGZlYXR1cmVPYmpzLCB1bmlxdWVLZXkpKSB7CiAgICAgICAgICAgICAgZmVhdHVyZU9ianNbdW5pcXVlS2V5XSA9IHt9OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vIFRoaXMgc2hvdWxkIG5vdCBoYXBwZW4KICAgICAgICAgICAgICBjb25zb2xlLmxvZygiV0FSTklORzogRHVwbGljYXRlIHVuaXF1ZUtleSAiLmNvbmNhdCh1bmlxdWVLZXksICIgaW4gcmV0cmlldmVkIGRhdGEuIikpOwogICAgICAgICAgICB9IC8vIENyZWF0ZSBuZXcgb2JqZWN0IHdpdGggbWFwcGVkIGtleXMgdG8gYWxsb3cgaW50ZWdyYXRpbmcgZGF0YQogICAgICAgICAgICAvLyBvZiBtdWx0aXBsZSBlbmRwb2ludHMKCgogICAgICAgICAgICBPYmplY3QuZW50cmllcyhwTSkuZm9yRWFjaChmdW5jdGlvbiAoX3JlZjYpIHsKICAgICAgICAgICAgICB2YXIgX3JlZjcgPSBfc2xpY2VkVG9BcnJheShfcmVmNiwgMiksCiAgICAgICAgICAgICAgICAgIGtleSA9IF9yZWY3WzBdLAogICAgICAgICAgICAgICAgICB2YWx1ZSA9IF9yZWY3WzFdOwoKICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGRhdGFbcnJdLCB2YWx1ZSkpIHsKICAgICAgICAgICAgICAgIGlmIChrZXkgPT09ICdzdWJBb2knKSB7CiAgICAgICAgICAgICAgICAgIC8vIGR1bW15IGVtcHR5IGdlb21ldHJ5CiAgICAgICAgICAgICAgICAgIHZhciBmdHJzID0gW107CgogICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIC8vIGFzc3VtaW5nIHN1Yi1hb2kgZG9lcyBub3QgY2hhbmdlIG92ZXIgdGltZQogICAgICAgICAgICAgICAgICAgIGlmICghWycnLCAnLyddLmluY2x1ZGVzKGRhdGFbcnJdW3ZhbHVlXSkpIHsKICAgICAgICAgICAgICAgICAgICAgIHdrdC5yZWFkKGRhdGFbcnJdW3ZhbHVlXSk7CiAgICAgICAgICAgICAgICAgICAgICB2YXIganNvbkdlb20gPSB3a3QudG9Kc29uKCk7IC8vIGNyZWF0ZSBhIGZlYXR1cmUgY29sbGVjdGlvbgoKICAgICAgICAgICAgICAgICAgICAgIGZ0cnMgPSBbewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHt9LAogICAgICAgICAgICAgICAgICAgICAgICBnZW9tZXRyeToganNvbkdlb20KICAgICAgICAgICAgICAgICAgICAgIH1dOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIHBhcnNpbmcgc3ViQW9pIG9mIGxvY2F0aW9ucyBmb3IgaW5kZXggIi5jb25jYXQocnIpKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgdmFyIGZ0ckNvbCA9IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzOiBmdHJzCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIGZlYXR1cmVPYmpzW3VuaXF1ZUtleV1ba2V5XSA9IGZ0ckNvbDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSAnbGFzdE1lYXN1cmVtZW50JykgewogICAgICAgICAgICAgICAgICBmZWF0dXJlT2Jqc1t1bmlxdWVLZXldW2tleV0gPSBkYXRhW3JyXVt2YWx1ZV0ubGVuZ3RoICE9PSAwID8gTnVtYmVyKGRhdGFbcnJdW3ZhbHVlXSkgOiBOYU47CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBmZWF0dXJlT2Jqc1t1bmlxdWVLZXldW2tleV0gPSBkYXRhW3JyXVt2YWx1ZV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH07CgogICAgICAgICAgZm9yICh2YXIgcnIgPSAwOyByciA8IGRhdGEubGVuZ3RoOyByciArPSAxKSB7CiAgICAgICAgICAgIF9sb29wKHJyKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGZlYXR1cmVPYmpzKTsKCiAgICAgICAgICBmb3IgKHZhciBrayA9IDA7IGtrIDwga2V5cy5sZW5ndGg7IGtrICs9IDEpIHsKICAgICAgICAgICAgdmFyIGNvb3JkcyA9IGtleXNba2tdLnNwbGl0KCdfJylbMF0ucmVwbGFjZSgnICcsICcnKS5zcGxpdCgnLCcpLm1hcChOdW1iZXIpOwogICAgICAgICAgICBmZWF0dXJlT2Jqc1trZXlzW2trXV0uYW9pID0gbGF0TG5nKFtjb29yZHNbMF0sIGNvb3Jkc1sxXV0pOwogICAgICAgICAgICBmZWF0dXJlT2Jqc1trZXlzW2trXV0uaWQgPSBnbG9iYWxJZENvdW50ZXI7IC8vIHRvIGNvbm5lY3QgaW5kaWNhdG9yICYgZmVhdHVyZQoKICAgICAgICAgICAgZmVhdHVyZU9ianNba2V5c1tra11dLmVuZFBvaW50SWR4ID0gZW5kUG9pbnRJZHg7CiAgICAgICAgICAgIGZlYXR1cmVzLnB1c2goewogICAgICAgICAgICAgIGxhdGxuZzogbGF0TG5nKFtjb29yZHNbMF0sIGNvb3Jkc1sxXV0pLAogICAgICAgICAgICAgIGlkOiBnbG9iYWxJZENvdW50ZXIsCiAgICAgICAgICAgICAgcHJvcGVydGllczogewogICAgICAgICAgICAgICAgaW5kaWNhdG9yT2JqZWN0OiBmZWF0dXJlT2Jqc1trZXlzW2trXV0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBnbG9iYWxJZENvdW50ZXIgKz0gMTsKICAgICAgICAgIH0KICAgICAgICB9KSgpOwogICAgICB9CgogICAgICByZXR1cm4gZmVhdHVyZXM7CiAgICB9KTsKICB9LAogIGxvYWRHZW9EQkVuZHBvaW50OiBmdW5jdGlvbiBsb2FkR2VvREJFbmRwb2ludChfcmVmOCwgX3JlZjkpIHsKICAgIHZhciByb290U3RhdGUgPSBfcmVmOC5yb290U3RhdGUsCiAgICAgICAgY29tbWl0ID0gX3JlZjguY29tbWl0OwogICAgdmFyIHVybCA9IF9yZWY5LnVybCwKICAgICAgICBlbmRQb2ludElkeCA9IF9yZWY5LmVuZFBvaW50SWR4OwogICAgcmV0dXJuIGZldGNoKHVybCwgewogICAgICBjcmVkZW50aWFsczogJ3NhbWUtb3JpZ2luJwogICAgfSkudGhlbihmdW5jdGlvbiAocikgewogICAgICByZXR1cm4gci5qc29uKCk7CiAgICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHZhciBmZWF0dXJlcyA9IFtdOwogICAgICB2YXIgcE0gPSB7CiAgICAgICAgYW9pOiAnYW9pJywKICAgICAgICBhb2lJRDogJ2FvaV9pZCcsCiAgICAgICAgbGFzdENvbG9yQ29kZTogJ2NvbG9yX2NvZGUnLAogICAgICAgIGNvdW50cnk6ICdjb3VudHJ5JywKICAgICAgICBnZW9tZXRyeTogJ2dlb21ldHJ5JywKICAgICAgICBpbmRpY2F0b3I6ICdpbmRpY2F0b3JfY29kZScsCiAgICAgICAgbGFzdEluZGljYXRvclZhbHVlOiAnaW5kaWNhdG9yX3ZhbHVlJywKICAgICAgICBsYXN0VGltZTogJ21heF90aW1lJywKICAgICAgICBsYXN0TWVhc3VyZW1lbnQ6ICdtZWFzdXJlbWVudF92YWx1ZScsCiAgICAgICAgc2l0ZU5hbWU6ICdzaXRlX25hbWUnLAogICAgICAgIHN1YkFvaTogJ3N1Yl9hb2knCiAgICAgICAgLyoKICAgICAgICBjaXR5OiAnY2l0eScsCiAgICAgICAgZGVzY3JpcHRpb246ICdkZXNjcmlwdGlvbicsCiAgICAgICAgaW5kaWNhdG9yTmFtZTogJ0luZGljYXRvciBOYW1lJywgLy8gbm90IHByZXNlbnQKICAgICAgICBsYXN0UmVmZXJlbmNlVGltZTogJ3JlZmVyZW5jZSBkYXRlIHRpbWUgW3l5eXktbW0tZGR0aGg6bW06c3NdJywKICAgICAgICBsYXN0UmVmZXJlbmNlVmFsdWU6ICdyZWZlcmVuY2UgdmFsdWUgW2Zsb2F0XScsCiAgICAgICAgcmVnaW9uOiAncmVnaW9uIChvcHRpb25hbCknLAogICAgICAgIHVwZGF0ZUZyZXF1ZW5jeTogJ3VwZGF0ZSBmcmVxdWVuY3knLCAvLyBub3QgcHJlc2VudAogICAgICAgIC8vIFByb2JhYmx5IG5vdCBuZWVkZWQgaW4gb3ZlcnZpZXcKICAgICAgICByZWZlcmVuY2VEZXNjcmlwdGlvbjogJ3JlZmVyZW5jZSBkZXNjcmlwdGlvbicsCiAgICAgICAgbWV0aG9kOiAnbWV0aG9kJywKICAgICAgICBydWxlOiAncnVsZScsCiAgICAgICAgZW9TZW5zb3I6ICdlbyBzZW5zb3InLAogICAgICAgIGlucHV0RGF0YTogJ2lucHV0IGRhdGEnLAogICAgICAgICovCgogICAgICB9OwogICAgICBjb21taXQoJ0FERF9SRVNVTFRTX0NPVU5UJywgewogICAgICAgIHR5cGU6IHJvb3RTdGF0ZS5jb25maWcuYmFzZUNvbmZpZy5pbmRpY2F0b3JzRGVmaW5pdGlvbltkYXRhWzBdW3BNLmluZGljYXRvcl1dWyJjbGFzcyJdLAogICAgICAgIGNvdW50OiBkYXRhLmxlbmd0aCAvLyBpbmRpdmlkdWFsIG1lYXN1cmVtZW50cwoKICAgICAgfSk7IC8vIG9ubHkgY29udGludWUgaWYgYW9pIGNvbHVtbiBpcyBwcmVzZW50CgogICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGRhdGFbMF0sIHBNLmFvaSkpIHsKICAgICAgICAoZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIHdrdCA9IG5ldyBXa3QoKTsKICAgICAgICAgIHZhciBmZWF0dXJlT2JqcyA9IHt9OwoKICAgICAgICAgIHZhciBfbG9vcDIgPSBmdW5jdGlvbiBfbG9vcDIocnIpIHsKICAgICAgICAgICAgLy8gQWdncmVnYXRlIGRhdGEgYmFzZWQgb24gbG9jYXRpb24KICAgICAgICAgICAgdmFyIHVuaXF1ZUtleSA9ICIiLmNvbmNhdChkYXRhW3JyXVtwTS5hb2ldLCAiXyIpLmNvbmNhdChkYXRhW3JyXVtwTS5pbmRpY2F0b3JdKTsKCiAgICAgICAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGZlYXR1cmVPYmpzLCB1bmlxdWVLZXkpKSB7CiAgICAgICAgICAgICAgZmVhdHVyZU9ianNbdW5pcXVlS2V5XSA9IHt9OyAvLyBUT0RPOiBSZW1vdmUgcGxhY2Vob2xkZXIgdGV4dAoKICAgICAgICAgICAgICBmZWF0dXJlT2Jqc1t1bmlxdWVLZXldLmRlc2NyaXB0aW9uID0gJ3BsYWNlaG9sZGVyIGRlc2NyaXB0aW9uJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAvLyBUaGlzIHNob3VsZCBub3QgaGFwcGVuCiAgICAgICAgICAgICAgY29uc29sZS5sb2coIldBUk5JTkc6IER1cGxpY2F0ZSB1bmlxdWVLZXkgIi5jb25jYXQodW5pcXVlS2V5LCAiIGluIHJldHJpZXZlZCBkYXRhLiIpKTsKICAgICAgICAgICAgfSAvLyBDcmVhdGUgbmV3IG9iamVjdCB3aXRoIG1hcHBlZCBrZXlzIHRvIGFsbG93IGludGVncmF0aW5nIGRhdGEKICAgICAgICAgICAgLy8gb2YgbXVsdGlwbGUgZW5kcG9pbnRzCgoKICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMocE0pLmZvckVhY2goZnVuY3Rpb24gKF9yZWYxMCkgewogICAgICAgICAgICAgIHZhciBfcmVmMTEgPSBfc2xpY2VkVG9BcnJheShfcmVmMTAsIDIpLAogICAgICAgICAgICAgICAgICBrZXkgPSBfcmVmMTFbMF0sCiAgICAgICAgICAgICAgICAgIHZhbHVlID0gX3JlZjExWzFdOwoKICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGRhdGFbcnJdLCB2YWx1ZSkpIHsKICAgICAgICAgICAgICAgIGlmIChrZXkgPT09ICdzdWJBb2knKSB7CiAgICAgICAgICAgICAgICAgIC8vIGR1bW15IGVtcHR5IGdlb21ldHJ5CiAgICAgICAgICAgICAgICAgIHZhciBmdHJzID0gW107CgogICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIC8vIGFzc3VtaW5nIHN1Yi1hb2kgZG9lcyBub3QgY2hhbmdlIG92ZXIgdGltZQogICAgICAgICAgICAgICAgICAgIGlmIChkYXRhW3JyXVt2YWx1ZV0gIT09ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgICB3a3QucmVhZChkYXRhW3JyXVt2YWx1ZV0pOwogICAgICAgICAgICAgICAgICAgICAgdmFyIGpzb25HZW9tID0gd2t0LnRvSnNvbigpOyAvLyBjcmVhdGUgYSBmZWF0dXJlIGNvbGxlY3Rpb24KCiAgICAgICAgICAgICAgICAgICAgICBmdHJzID0gW3sKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLAogICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnk6IGpzb25HZW9tCiAgICAgICAgICAgICAgICAgICAgICB9XTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciBwYXJzaW5nIHN1YkFvaSBvZiBsb2NhdGlvbnMgZm9yIGluZGV4ICIuY29uY2F0KHJyKSk7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHZhciBmdHJDb2wgPSB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywKICAgICAgICAgICAgICAgICAgICBmZWF0dXJlczogZnRycwogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICBmZWF0dXJlT2Jqc1t1bmlxdWVLZXldW2tleV0gPSBmdHJDb2w7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ2xhc3RNZWFzdXJlbWVudCcpIHsKICAgICAgICAgICAgICAgICAgZmVhdHVyZU9ianNbdW5pcXVlS2V5XVtrZXldID0gZGF0YVtycl1bdmFsdWVdLmxlbmd0aCAhPT0gMCA/IE51bWJlcihkYXRhW3JyXVt2YWx1ZV0pIDogTmFOOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgZmVhdHVyZU9ianNbdW5pcXVlS2V5XVtrZXldID0gZGF0YVtycl1bdmFsdWVdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9OwoKICAgICAgICAgIGZvciAodmFyIHJyID0gMDsgcnIgPCBkYXRhLmxlbmd0aDsgcnIgKz0gMSkgewogICAgICAgICAgICBfbG9vcDIocnIpOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZmVhdHVyZU9ianMpOwoKICAgICAgICAgIGZvciAodmFyIGtrID0gMDsga2sgPCBrZXlzLmxlbmd0aDsga2sgKz0gMSkgewogICAgICAgICAgICB2YXIgY29vcmRzID0ga2V5c1tra10uc3BsaXQoJ18nKVswXS5yZXBsYWNlKCdQT0lOVCgnLCAnJykucmVwbGFjZSgnKScsICcnKS5zcGxpdCgnICcpLm1hcChOdW1iZXIpOwogICAgICAgICAgICBmZWF0dXJlT2Jqc1trZXlzW2trXV0uYW9pID0gbGF0TG5nKFtjb29yZHNbMV0sIGNvb3Jkc1swXV0pOwogICAgICAgICAgICBmZWF0dXJlT2Jqc1trZXlzW2trXV0uaWQgPSBnbG9iYWxJZENvdW50ZXI7IC8vIHRvIGNvbm5lY3QgaW5kaWNhdG9yICYgZmVhdHVyZQoKICAgICAgICAgICAgZmVhdHVyZU9ianNba2V5c1tra11dLmVuZFBvaW50SWR4ID0gZW5kUG9pbnRJZHg7CiAgICAgICAgICAgIGZlYXR1cmVzLnB1c2goewogICAgICAgICAgICAgIGxhdGxuZzogbGF0TG5nKFtjb29yZHNbMV0sIGNvb3Jkc1swXV0pLAogICAgICAgICAgICAgIGlkOiBnbG9iYWxJZENvdW50ZXIsCiAgICAgICAgICAgICAgcHJvcGVydGllczogewogICAgICAgICAgICAgICAgaW5kaWNhdG9yT2JqZWN0OiBmZWF0dXJlT2Jqc1trZXlzW2trXV0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBnbG9iYWxJZENvdW50ZXIgKz0gMTsKICAgICAgICAgIH0KICAgICAgICB9KSgpOwogICAgICB9CgogICAgICByZXR1cm4gZmVhdHVyZXM7CiAgICB9KTsKICB9LAogIGxvYWREdW1teUxvY2F0aW9uczogZnVuY3Rpb24gbG9hZER1bW15TG9jYXRpb25zKF9yZWYxMikgewogICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgdmFyIHJvb3RTdGF0ZSA9IF9yZWYxMi5yb290U3RhdGU7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgX3RoaXMyLl92bS4kcGFwYS5wYXJzZShyb290U3RhdGUuY29uZmlnLmFwcENvbmZpZy5kaXNwbGF5RHVtbXlMb2NhdGlvbnMsIHsKICAgICAgICBkb3dubG9hZDogdHJ1ZSwKICAgICAgICBxdW90ZXM6IHRydWUsCiAgICAgICAgaGVhZGVyOiB0cnVlLAogICAgICAgIHNraXBFbXB0eUxpbmVzOiB0cnVlLAogICAgICAgIGRlbGltaXRlcjogJywnLAogICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiBjb21wbGV0ZShyZXN1bHQpIHsKICAgICAgICAgIHZhciBkYXRhID0gcmVzdWx0LmRhdGE7CiAgICAgICAgICB2YXIgZmVhdHVyZU9ianMgPSB7fTsKCiAgICAgICAgICBmb3IgKHZhciByciA9IDA7IHJyIDwgZGF0YS5sZW5ndGg7IHJyICs9IDEpIHsKICAgICAgICAgICAgdmFyIHVuaXF1ZUtleSA9ICIiLmNvbmNhdChkYXRhW3JyXS5hb2ksICJfZCIpOwogICAgICAgICAgICBmZWF0dXJlT2Jqc1t1bmlxdWVLZXldID0gZGF0YVtycl07CiAgICAgICAgICAgIGZlYXR1cmVPYmpzW3VuaXF1ZUtleV0uaW5kaWNhdG9yID0gJ2QnOwogICAgICAgICAgICBmZWF0dXJlT2Jqc1t1bmlxdWVLZXldLmluZGljYXRvclZhbHVlID0gWycnXTsKICAgICAgICAgICAgZmVhdHVyZU9ianNbdW5pcXVlS2V5XS5kdW1teUZlYXR1cmUgPSB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBmZWF0dXJlcyA9IFtdOwogICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhmZWF0dXJlT2Jqcyk7CgogICAgICAgICAgZm9yICh2YXIga2sgPSAwOyBrayA8IGtleXMubGVuZ3RoOyBrayArPSAxKSB7CiAgICAgICAgICAgIHZhciBjb29yZGluYXRlcyA9IGtleXNba2tdLnNwbGl0KCdfJylbMF0uc3BsaXQoJywnKS5tYXAoTnVtYmVyKTsKICAgICAgICAgICAgZmVhdHVyZU9ianNba2V5c1tra11dLmlkID0gZ2xvYmFsSWRDb3VudGVyOyAvLyB0byBjb25uZWN0IGluZGljYXRvciAmIGZlYXR1cmUKCiAgICAgICAgICAgIGZlYXR1cmVzLnB1c2goewogICAgICAgICAgICAgIGxhdGxuZzogbGF0TG5nKGNvb3JkaW5hdGVzKSwKICAgICAgICAgICAgICBpZDogZ2xvYmFsSWRDb3VudGVyLAogICAgICAgICAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICAgICAgICAgIGluZGljYXRvck9iamVjdDogZmVhdHVyZU9ianNba2V5c1tra11dCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZ2xvYmFsSWRDb3VudGVyICs9IDE7CiAgICAgICAgICB9CgogICAgICAgICAgcmVzb2x2ZShmZWF0dXJlcyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHN0YXRlLAogIGdldHRlcnM6IGdldHRlcnMsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMsCiAgYWN0aW9uczogYWN0aW9ucwp9Ow=="},null]}